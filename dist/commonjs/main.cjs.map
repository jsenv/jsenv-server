{
  "version": 3,
  "file": "main.cjs",
  "sources": [
    "../../src/acceptsContentType.js",
    "../../src/internal/compositionMappingToComposeStrict.js",
    "../../src/internal/compositionMappingToCompose.js",
    "../../src/internal/composeResponseHeaders.js",
    "../../src/composeResponse.js",
    "../../src/convertFileSystemErrorToResponseProperties.js",
    "../../node_modules/@jsenv/logger/src/LOG_LEVELS.js",
    "../../node_modules/@jsenv/logger/src/createLogger.js",
    "../../src/internal/observable.js",
    "../../src/createSSERoom.js",
    "../../node_modules/@jsenv/core/src/internal/bundling/import-meta-commonjs.js",
    "../../node_modules/@jsenv/cancellation/src/createCancellationToken.js",
    "../../node_modules/@jsenv/cancellation/src/internal/memoizeOnce.js",
    "../../node_modules/@jsenv/cancellation/src/operation/createOperation.js",
    "../../node_modules/@jsenv/cancellation/src/operation/createStoppableOperation.js",
    "../../node_modules/@jsenv/cancellation/src/operation/firstOperationMatching.js",
    "../../node_modules/@jsenv/cancellation/src/cancelError.js",
    "../../node_modules/@jsenv/cancellation/src/composeCancellationToken.js",
    "../../node_modules/@jsenv/cancellation/src/internal/arrayHelper.js",
    "../../node_modules/@jsenv/cancellation/src/createCancellationSource.js",
    "../../node_modules/@jsenv/node-signals/src/SIGUPSignal.js",
    "../../node_modules/@jsenv/node-signals/src/SIGINTSignal.js",
    "../../node_modules/@jsenv/node-signals/src/SIGTERMSignal.js",
    "../../node_modules/@jsenv/node-signals/src/beforeExitSignal.js",
    "../../node_modules/@jsenv/node-signals/src/exitSignal.js",
    "../../node_modules/@jsenv/node-signals/src/teardownSignal.js",
    "../../node_modules/@jsenv/node-signals/src/internal/firstOperationMatching.js",
    "../../node_modules/@jsenv/node-signals/src/unadvisedCrashSignal.js",
    "../../node_modules/@jsenv/cancellation/src/internal/wrapFunctionToCatchCancellation.js",
    "../../node_modules/@jsenv/cancellation/src/internal/wrapFunctionToConsiderUnhandledRejectionsAsExceptions.js",
    "../../node_modules/@jsenv/cancellation/src/executeAsyncFunction.js",
    "../../node_modules/@jsenv/util/src/internal/ensureUrlTrailingSlash.js",
    "../../node_modules/@jsenv/util/src/isFileSystemPath.js",
    "../../node_modules/@jsenv/util/src/fileSystemPathToUrl.js",
    "../../node_modules/@jsenv/util/src/assertAndNormalizeDirectoryUrl.js",
    "../../node_modules/@jsenv/util/src/assertAndNormalizeFileUrl.js",
    "../../node_modules/@jsenv/util/src/urlToFileSystemPath.js",
    "../../node_modules/@jsenv/util/src/readFileSystemNodeStat.js",
    "../../node_modules/@jsenv/util/src/bufferToEtag.js",
    "../../node_modules/@jsenv/util/src/readDirectory.js",
    "../../node_modules/@jsenv/util/src/ensureWindowsDriveLetter.js",
    "../../node_modules/@jsenv/util/src/writeSymbolicLink.js",
    "../../node_modules/@jsenv/util/src/memoize.js",
    "../../node_modules/@jsenv/util/src/readFile.js",
    "../../node_modules/@jsenv/util/src/internal/createWatcher.js",
    "../../node_modules/@jsenv/util/src/registerDirectoryLifecycle.js",
    "../../src/serverTiming.js",
    "../../src/jsenvContentTypeMap.js",
    "../../src/urlToContentType.js",
    "../../src/serveFile.js",
    "../../src/fetchUrl.js",
    "../../src/internal/listen.js",
    "../../src/findFreePort.js",
    "../../src/firstService.js",
    "../../src/jsenvAccessControlAllowedHeaders.js",
    "../../src/jsenvAccessControlAllowedMethods.js",
    "../../src/jsenvSignature.js",
    "../../src/urlToSearchParamValue.js",
    "../../src/readRequestBodyAsString.js",
    "../../src/internal/createTracker.js",
    "../../src/internal/urlToOrigin.js",
    "../../src/internal/createServer.js",
    "../../src/internal/trackServerPendingConnections.js",
    "../../src/internal/trackServerPendingRequests.js",
    "../../src/internal/nodeStreamToObservable.js",
    "../../src/internal/normalizeHeaderName.js",
    "../../src/internal/normalizeHeaderValue.js",
    "../../src/internal/headersFromObject.js",
    "../../src/internal/nodeRequestToRequest.js",
    "../../src/internal/valueToObservable.js",
    "../../src/internal/populateNodeResponse.js",
    "../../src/internal/colorizeResponseStatus.js",
    "../../src/internal/getServerOrigins.js",
    "../../src/stopReasons.js",
    "../../src/internal/trackServerRequest.js",
    "../../src/startServer.js"
  ],
  "sourcesContent": [
    "export const acceptsContentType = (acceptHeader, contentType) => {\n  if (typeof acceptHeader !== \"string\") {\n    return false\n  }\n\n  return acceptHeader.split(\",\").some((acceptRaw) => {\n    const accept = parseAccept(acceptRaw)\n    return typeMatches(contentType, accept.type)\n  })\n}\n\nconst parseAccept = (accept) => {\n  const acceptTrimmed = accept.trim()\n  const scoreIndex = acceptTrimmed.indexOf(\";q=\")\n\n  let type\n  let score\n  if (scoreIndex > -1) {\n    const beforeScore = acceptTrimmed.slice(0, scoreIndex)\n    const afterScore = acceptTrimmed.slice(scoreIndex + \";q=\".length)\n    type = beforeScore\n    score = parseFloat(afterScore)\n  } else {\n    type = acceptTrimmed\n    score = 1\n  }\n\n  return {\n    type,\n    score,\n  }\n}\n\nconst typeMatches = (type, pattern) => {\n  const typeComposition = decomposeType(type)\n  const patternComposition = decomposeType(pattern)\n\n  if (patternComposition.type === \"*\") {\n    if (patternComposition.subtype === \"*\") return true\n    return patternComposition.subtype === typeComposition.subtype\n  }\n  if (patternComposition.type === typeComposition.type) {\n    if (patternComposition.subtype === \"*\") return true\n    return patternComposition.subtype === typeComposition.subtype\n  }\n  return false\n}\n\nconst decomposeType = (fullType) => {\n  const parts = fullType.split(\"/\")\n  const type = parts[0]\n  const subtype = parts[1]\n  return { type, subtype }\n}\n",
    "export const compositionMappingToComposeStrict = (\n  compositionMapping,\n  createInitial = () => ({}),\n) => {\n  const reducer = compositionMappingToStrictReducer(compositionMapping)\n  return (...objects) => objects.reduce(reducer, createInitial())\n}\n\nconst compositionMappingToStrictReducer = (compositionMapping) => {\n  const propertyComposeStrict = (key, previous, current) => {\n    const propertyExistInCurrent = key in current\n    if (!propertyExistInCurrent) return previous[key]\n\n    const propertyExistInPrevious = key in previous\n    if (!propertyExistInPrevious) return current[key]\n\n    const composeProperty = compositionMapping[key]\n    return composeProperty(previous[key], current[key])\n  }\n\n  return (previous, current) => {\n    if (typeof current !== \"object\" || current === null) return previous\n\n    const composed = {}\n    Object.keys(compositionMapping).forEach((key) => {\n      composed[key] = propertyComposeStrict(key, previous, current)\n    })\n    return composed\n  }\n}\n",
    "export const compositionMappingToCompose = (compositionMapping, createInitial = () => ({})) => {\n  const reducer = compositionMappingToReducer(compositionMapping)\n  return (...objects) => objects.reduce(reducer, createInitial())\n}\n\nconst compositionMappingToReducer = (compositionMapping) => {\n  const composeProperty = (key, previous, current) => {\n    const propertyExistInCurrent = key in current\n    if (!propertyExistInCurrent) return previous[key]\n\n    const propertyExistInPrevious = key in previous\n    if (!propertyExistInPrevious) return current[key]\n\n    const propertyHasComposer = key in compositionMapping\n    if (!propertyHasComposer) return current[key]\n\n    const composerForProperty = compositionMapping[key]\n    return composerForProperty(previous[key], current[key])\n  }\n\n  return (previous, current) => {\n    if (typeof current !== \"object\" || current === null) return previous\n\n    const composed = { ...previous }\n    Object.keys(current).forEach((key) => {\n      composed[key] = composeProperty(key, previous, current)\n    })\n    return composed\n  }\n}\n",
    "import { compositionMappingToCompose } from \"./compositionMappingToCompose.js\"\n\nconst composeHeaderValues = (value, nextValue) => {\n  const headerValues = value.split(\", \")\n  nextValue.split(\", \").forEach((value) => {\n    if (!headerValues.includes(value)) {\n      headerValues.push(value)\n    }\n  })\n  return headerValues.join(\", \")\n}\n\nconst headerCompositionMapping = {\n  \"accept\": composeHeaderValues,\n  \"accept-charset\": composeHeaderValues,\n  \"accept-language\": composeHeaderValues,\n  \"access-control-allow-headers\": composeHeaderValues,\n  \"access-control-allow-methods\": composeHeaderValues,\n  \"access-control-allow-origin\": composeHeaderValues,\n  // https://www.w3.org/TR/server-timing/\n  // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Server-Timing\n  \"server-timing\": composeHeaderValues,\n  // 'content-type', // https://github.com/ninenines/cowboy/issues/1230\n  \"vary\": composeHeaderValues,\n}\n\nexport const composeResponseHeaders = compositionMappingToCompose(headerCompositionMapping)\n",
    "import { compositionMappingToComposeStrict } from \"./internal/compositionMappingToComposeStrict.js\"\nimport { composeResponseHeaders } from \"./internal/composeResponseHeaders.js\"\n\nconst responseCompositionMapping = {\n  status: (prevStatus, status) => status,\n  statusText: (prevStatusText, statusText) => statusText,\n  headers: composeResponseHeaders,\n  body: (prevBody, body) => body,\n  bodyEncoding: (prevEncoding, encoding) => encoding,\n  timing: (prevTiming, timing) => {\n    return { ...prevTiming, ...timing }\n  },\n}\n\nexport const composeResponse = compositionMappingToComposeStrict(responseCompositionMapping)\n",
    "export const convertFileSystemErrorToResponseProperties = (error) => {\n  // https://iojs.org/api/errors.html#errors_eacces_permission_denied\n  if (isErrorWithCode(error, \"EACCES\")) {\n    return {\n      status: 403,\n      statusText: `EACCES: No permission to read file at ${error.path}`,\n    }\n  }\n\n  if (isErrorWithCode(error, \"EPERM\")) {\n    return {\n      status: 403,\n      statusText: `EPERM: No permission to read file at ${error.path}`,\n    }\n  }\n\n  if (isErrorWithCode(error, \"ENOENT\")) {\n    return {\n      status: 404,\n      statusText: `ENOENT: File not found at ${error.path}`,\n    }\n  }\n\n  // file access may be temporarily blocked\n  // (by an antivirus scanning it because recently modified for instance)\n  if (isErrorWithCode(error, \"EBUSY\")) {\n    return {\n      status: 503,\n      statusText: `EBUSY: File is busy ${error.path}`,\n      headers: {\n        \"retry-after\": 0.01, // retry in 10ms\n      },\n    }\n  }\n\n  // emfile means there is too many files currently opened\n  if (isErrorWithCode(error, \"EMFILE\")) {\n    return {\n      status: 503,\n      statusText: \"EMFILE: too many file opened\",\n      headers: {\n        \"retry-after\": 0.1, // retry in 100ms\n      },\n    }\n  }\n\n  if (isErrorWithCode(error, \"EISDIR\")) {\n    return {\n      status: 500,\n      statusText: `EISDIR: Unexpected directory operation at ${error.path}`,\n    }\n  }\n\n  return Promise.reject(error)\n}\n\nconst isErrorWithCode = (error, code) => {\n  return typeof error === \"object\" && error.code === code\n}\n",
    "export const LOG_LEVEL_OFF = \"off\"\n\nexport const LOG_LEVEL_DEBUG = \"debug\"\n\nexport const LOG_LEVEL_INFO = \"info\"\n\nexport const LOG_LEVEL_WARN = \"warn\"\n\nexport const LOG_LEVEL_ERROR = \"error\"\n",
    "import {\n  LOG_LEVEL_DEBUG,\n  LOG_LEVEL_INFO,\n  LOG_LEVEL_WARN,\n  LOG_LEVEL_ERROR,\n  LOG_LEVEL_OFF,\n} from \"./LOG_LEVELS.js\"\n\nexport const createLogger = ({ logLevel = LOG_LEVEL_INFO } = {}) => {\n  if (logLevel === LOG_LEVEL_DEBUG) {\n    return {\n      debug,\n      info,\n      warn,\n      error,\n    }\n  }\n\n  if (logLevel === LOG_LEVEL_INFO) {\n    return {\n      debug: debugDisabled,\n      info,\n      warn,\n      error,\n    }\n  }\n\n  if (logLevel === LOG_LEVEL_WARN) {\n    return {\n      debug: debugDisabled,\n      info: infoDisabled,\n      warn,\n      error,\n    }\n  }\n\n  if (logLevel === LOG_LEVEL_ERROR) {\n    return {\n      debug: debugDisabled,\n      info: infoDisabled,\n      warn: warnDisabled,\n      error,\n    }\n  }\n\n  if (logLevel === LOG_LEVEL_OFF) {\n    return {\n      debug: debugDisabled,\n      info: infoDisabled,\n      warn: warnDisabled,\n      error: errorDisabled,\n    }\n  }\n\n  throw new Error(`unexpected logLevel.\n--- logLevel ---\n${logLevel}\n--- allowed log levels ---\n${LOG_LEVEL_OFF}\n${LOG_LEVEL_ERROR}\n${LOG_LEVEL_WARN}\n${LOG_LEVEL_INFO}\n${LOG_LEVEL_DEBUG}`)\n}\n\nconst debug = console.debug\n\nconst debugDisabled = () => {}\n\nconst info = console.info\n\nconst infoDisabled = () => {}\n\nconst warn = console.warn\n\nconst warnDisabled = () => {}\n\nconst error = console.error\n\nconst errorDisabled = () => {}\n\nconst disabledMethods = {\n  debug: debugDisabled,\n  info: infoDisabled,\n  warn: warnDisabled,\n  error: errorDisabled,\n}\n\nexport const loggerIsMethodEnabled = (logger, methodName) => {\n  return logger[methodName] !== disabledMethods[methodName]\n}\n\nexport const loggerToLevels = (logger) => {\n  return {\n    debug: loggerIsMethodEnabled(logger, \"debug\"),\n    info: loggerIsMethodEnabled(logger, \"info\"),\n    warn: loggerIsMethodEnabled(logger, \"warn\"),\n    error: loggerIsMethodEnabled(logger, \"error\"),\n  }\n}\n\nexport const loggerToLogLevel = (logger) => {\n  if (loggerIsMethodEnabled(logger, \"debug\")) return LOG_LEVEL_DEBUG\n  if (loggerIsMethodEnabled(logger, \"info\")) return LOG_LEVEL_INFO\n  if (loggerIsMethodEnabled(logger, \"warn\")) return LOG_LEVEL_WARN\n  if (loggerIsMethodEnabled(logger, \"error\")) return LOG_LEVEL_ERROR\n  return LOG_LEVEL_OFF\n}\n",
    "if (\"observable\" in Symbol === false) {\n  Symbol.observable = Symbol.for(\"observable\")\n}\n\nexport const createObservable = ({ subscribe }) => {\n  const observable = {\n    [Symbol.observable]: () => observable,\n    subscribe,\n  }\n  return observable\n}\n\nexport const subscribe = (\n  observable,\n  {\n    next = () => {},\n    error = (value) => {\n      throw value\n    },\n    complete = () => {},\n  },\n) => {\n  const { subscribe } = observable[Symbol.observable]()\n  const subscription = subscribe({\n    next,\n    error,\n    complete,\n  })\n  return subscription || { unsubscribe: () => {} }\n}\n\nexport const isObservable = (value) => {\n  if (value === null) return false\n  if (value === undefined) return false\n  if (typeof value === \"object\") return Symbol.observable in value\n  if (typeof value === \"function\") return Symbol.observable in value\n  return false\n}\n",
    "import { createLogger } from \"@jsenv/logger\"\nimport { createObservable } from \"./internal/observable.js\"\n\n// https://www.html5rocks.com/en/tutorials/eventsource/basics/\nexport const createSSERoom = ({\n  logLevel,\n  keepaliveDuration = 30 * 1000,\n  retryDuration = 1 * 1000,\n  historyLength = 1 * 1000,\n  maxConnectionAllowed = 100, // max 100 users accepted\n  computeEventId = (event, lastEventId) => lastEventId + 1,\n  welcomeEvent = false,\n  welcomeEventPublic = false,\n} = {}) => {\n  const logger = createLogger({ logLevel })\n\n  const connections = new Set()\n  const eventHistory = createEventHistory(historyLength)\n  // what about previousEventId that keeps growing ?\n  // we could add some limit\n  // one limit could be that an event older than 24h is deleted\n  let previousEventId = 0\n  let state = \"closed\"\n  let interval\n\n  const eventsSince = (id) => {\n    const events = eventHistory.since(id)\n    if (welcomeEvent && !welcomeEventPublic) {\n      return events.filter((event) => event.type !== \"welcome\")\n    }\n    return events\n  }\n\n  const connect = (lastKnownId) => {\n    if (connections.size > maxConnectionAllowed) {\n      return {\n        status: 503,\n      }\n    }\n    if (state === \"closed\") {\n      return {\n        status: 204,\n      }\n    }\n\n    const firstEvent = {\n      retry: retryDuration,\n      type: welcomeEvent ? \"welcome\" : \"comment\",\n      data: new Date().toLocaleTimeString(),\n    }\n\n    if (welcomeEvent) {\n      firstEvent.id = computeEventId(firstEvent, previousEventId)\n      previousEventId = firstEvent.id\n      eventHistory.add(firstEvent)\n    }\n\n    const events = [\n      // send events which occured between lastKnownId & now\n      ...(lastKnownId === undefined ? [] : eventsSince(lastKnownId)),\n      firstEvent,\n    ]\n\n    const body = createObservable({\n      subscribe: ({ next }) => {\n        events.forEach((event) => {\n          logger.debug(`send ${event.type} event to this new client`)\n          next(stringifySourceEvent(event))\n        })\n\n        const connection = {\n          write: next,\n        }\n\n        const unsubscribe = () => {\n          connections.delete(connection)\n          logger.debug(\n            `connection closed by us, number of client connected to event source: ${connections.size}`,\n          )\n        }\n\n        connection.unsubscribe = unsubscribe\n        connections.add(connection)\n\n        return {\n          unsubscribe,\n        }\n      },\n    })\n\n    logger.debug(\n      `client joined, number of client connected to event source: ${connections.size}, max allowed: ${maxConnectionAllowed}`,\n    )\n\n    return {\n      status: 200,\n      headers: {\n        \"content-type\": \"text/event-stream\",\n        \"cache-control\": \"no-store\",\n        \"connection\": \"keep-alive\",\n      },\n      body,\n    }\n  }\n\n  const write = (data) => {\n    connections.forEach((connection) => {\n      connection.write(data)\n    })\n  }\n\n  const sendEvent = (event) => {\n    if (event.type !== \"comment\") {\n      logger.debug(\n        `send ${event.type} event, number of client listening event source: ${connections.size}`,\n      )\n      if (typeof event.id === \"undefined\") {\n        event.id = computeEventId(event, previousEventId)\n      }\n      previousEventId = event.id\n      eventHistory.add(event)\n    }\n\n    write(stringifySourceEvent(event))\n  }\n\n  const keepAlive = () => {\n    // maybe that, when an event occurs, we can delay the keep alive event\n    logger.debug(\n      `send keep alive event, number of client listening event source: ${connections.size}`,\n    )\n    sendEvent({\n      type: \"comment\",\n      data: new Date().toLocaleTimeString(),\n    })\n  }\n\n  const start = () => {\n    state = \"started\"\n    interval = setInterval(keepAlive, keepaliveDuration)\n  }\n\n  const stop = () => {\n    logger.debug(`stopping, number of client to close: ${connections.size}`)\n    connections.forEach((connection) => connection.unsubscribe())\n    clearInterval(interval)\n    eventHistory.reset()\n    state = \"stopped\"\n  }\n\n  return {\n    start,\n    stop,\n    connect,\n    eventsSince,\n    sendEvent,\n  }\n}\n\n// https://github.com/dmail-old/project/commit/da7d2c88fc8273850812972885d030a22f9d7448\n// https://github.com/dmail-old/project/commit/98b3ae6748d461ac4bd9c48944a551b1128f4459\n\n// https://github.com/dmail-old/http-eventsource/blob/master/lib/event-source.js\n\n// http://html5doctor.com/server-sent-events/\nconst stringifySourceEvent = ({ data, type = \"message\", id, retry }) => {\n  let string = \"\"\n\n  if (id !== undefined) {\n    string += `id:${id}\\n`\n  }\n\n  if (retry) {\n    string += `retry:${retry}\\n`\n  }\n\n  if (type !== \"message\") {\n    string += `event:${type}\\n`\n  }\n\n  string += `data:${data}\\n\\n`\n\n  return string\n}\n\nconst createEventHistory = (limit) => {\n  const events = []\n\n  const add = (data) => {\n    events.push(data)\n\n    if (events.length >= limit) {\n      events.shift()\n    }\n  }\n\n  const since = (id) => {\n    const index = events.findIndex((event) => String(event.id) === id)\n    return index === -1 ? [] : events.slice(index + 1)\n  }\n\n  const reset = () => {\n    events.length = 0\n  }\n\n  return { add, since, reset }\n}\n",
    "/* global require, __filename */\n// eslint-disable-next-line import/no-unresolved\nimport importMap from \"/jsenv.importmap\"\nimport { normalizeImportMap } from \"@jsenv/import-map/src/normalizeImportMap.js\"\nimport { resolveImport } from \"@jsenv/import-map/src/resolveImport.js\"\n\nconst nodeRequire = require\nexport { nodeRequire as require }\n\nconst filenameContainsBackSlashes = __filename.indexOf(\"\\\\\") > -1\n\nexport const url = filenameContainsBackSlashes\n  ? `file:///${__filename.replace(/\\\\/g, \"/\")}`\n  : `file://${__filename}`\n\nexport const resolve = (specifier) => {\n  return Promise.resolve(\n    resolveImport({\n      specifier,\n      importer: url,\n      importMap: memoizedGetImportMap(),\n      defaultExtension: false,\n    }),\n  )\n}\n\n// better for perf and helps rollup to tree shake this out\n// when import.meta.resolve is not used\nlet memoizedImportMap\nconst memoizedGetImportMap = () => {\n  if (memoizedImportMap) return memoizedImportMap\n  memoizedImportMap = normalizeImportMap(importMap, url)\n  return memoizedImportMap\n}\n",
    "export const createCancellationToken = () => {\n  const register = (callback) => {\n    if (typeof callback !== \"function\") {\n      throw new Error(`callback must be a function, got ${callback}`)\n    }\n\n    return {\n      callback,\n      unregister: () => {},\n    }\n  }\n\n  const throwIfRequested = () => undefined\n\n  return {\n    register,\n    cancellationRequested: false,\n    throwIfRequested,\n  }\n}\n",
    "export const memoizeOnce = (compute) => {\n  let locked = false\n  let lockValue\n\n  const memoized = (...args) => {\n    if (locked) return lockValue\n    // if compute is recursive wait for it to be fully done before storing the lockValue\n    // so set locked later\n    lockValue = compute(...args)\n    locked = true\n    return lockValue\n  }\n\n  memoized.deleteCache = () => {\n    const value = lockValue\n    locked = false\n    lockValue = undefined\n    return value\n  }\n\n  return memoized\n}\n",
    "import { createCancellationToken } from \"../createCancellationToken.js\"\n\nexport const createOperation = ({\n  cancellationToken = createCancellationToken(),\n  start,\n  ...rest\n}) => {\n  const unknownArgumentNames = Object.keys(rest)\n  if (unknownArgumentNames.length) {\n    throw new Error(`createOperation called with unknown argument names.\n--- unknown argument names ---\n${unknownArgumentNames}\n--- possible argument names ---\ncancellationToken\nstart`)\n  }\n\n  cancellationToken.throwIfRequested()\n  const promise = new Promise((resolve) => {\n    resolve(start())\n  })\n  const cancelPromise = new Promise((resolve, reject) => {\n    const cancelRegistration = cancellationToken.register((cancelError) => {\n      cancelRegistration.unregister()\n      reject(cancelError)\n    })\n    promise.then(cancelRegistration.unregister, () => {})\n  })\n  const operationPromise = Promise.race([promise, cancelPromise])\n\n  return operationPromise\n}\n",
    "import { createCancellationToken } from \"../createCancellationToken.js\"\nimport { memoizeOnce } from \"../internal/memoizeOnce.js\"\n\nexport const createStoppableOperation = ({\n  cancellationToken = createCancellationToken(),\n  start,\n  stop,\n  ...rest\n}) => {\n  if (typeof stop !== \"function\") {\n    throw new TypeError(`stop must be a function. got ${stop}`)\n  }\n  const unknownArgumentNames = Object.keys(rest)\n  if (unknownArgumentNames.length) {\n    throw new Error(`createStoppableOperation called with unknown argument names.\n--- unknown argument names ---\n${unknownArgumentNames}\n--- possible argument names ---\ncancellationToken\nstart\nstop`)\n  }\n  cancellationToken.throwIfRequested()\n\n  const promise = new Promise((resolve) => {\n    resolve(start())\n  })\n  const cancelPromise = new Promise((resolve, reject) => {\n    const cancelRegistration = cancellationToken.register((cancelError) => {\n      cancelRegistration.unregister()\n      reject(cancelError)\n    })\n    promise.then(cancelRegistration.unregister, () => {})\n  })\n  const operationPromise = Promise.race([promise, cancelPromise])\n\n  const stopInternal = memoizeOnce(async (reason) => {\n    const value = await promise\n    return stop(value, reason)\n  })\n  cancellationToken.register(stopInternal)\n  operationPromise.stop = stopInternal\n\n  return operationPromise\n}\n",
    "export const firstOperationMatching = ({ array, start, predicate }) => {\n  if (typeof array !== \"object\") {\n    throw new TypeError(`array must be an object, got ${array}`)\n  }\n  if (typeof start !== \"function\") {\n    throw new TypeError(`start must be a function, got ${start}`)\n  }\n  if (typeof predicate !== \"function\") {\n    throw new TypeError(`predicate must be a function, got ${predicate}`)\n  }\n\n  const visit = async (index) => {\n    if (index >= array.length) {\n      return undefined\n    }\n    const input = array[index]\n    const output = await start(input)\n    if (predicate(output)) {\n      return output\n    }\n    return visit(index + 1)\n  }\n\n  return visit(0)\n}\n",
    "export const createCancelError = (reason) => {\n  const cancelError = new Error(`canceled because ${reason}`)\n  cancelError.name = \"CANCEL_ERROR\"\n  cancelError.reason = reason\n  return cancelError\n}\n\nexport const isCancelError = (value) => {\n  return value && typeof value === \"object\" && value.name === \"CANCEL_ERROR\"\n}\n\nexport const errorToCancelReason = (error) => {\n  if (!isCancelError(error)) return \"\"\n  return error.reason\n}\n",
    "export const composeCancellationToken = (...tokens) => {\n  const register = (callback) => {\n    if (typeof callback !== \"function\") {\n      throw new Error(`callback must be a function, got ${callback}`)\n    }\n\n    const registrationArray = []\n\n    const visit = (i) => {\n      const token = tokens[i]\n      const registration = token.register(callback)\n      registrationArray.push(registration)\n    }\n    let i = 0\n    while (i < tokens.length) {\n      visit(i++)\n    }\n\n    const compositeRegistration = {\n      callback,\n      unregister: () => {\n        registrationArray.forEach((registration) => registration.unregister())\n        registrationArray.length = 0\n      },\n    }\n\n    return compositeRegistration\n  }\n\n  let requested = false\n  let cancelError\n  const internalRegistration = register((parentCancelError) => {\n    requested = true\n    cancelError = parentCancelError\n    internalRegistration.unregister()\n  })\n\n  const throwIfRequested = () => {\n    if (requested) {\n      throw cancelError\n    }\n  }\n\n  return {\n    register,\n    get cancellationRequested() {\n      return requested\n    },\n    throwIfRequested,\n  }\n}\n",
    "export const arrayWithout = (array, item) => {\n  const arrayWithoutItem = []\n  let i = 0\n  while (i < array.length) {\n    const value = array[i]\n    i++\n    if (value === item) {\n      continue\n    }\n    arrayWithoutItem.push(value)\n  }\n  return arrayWithoutItem\n}\n",
    "// https://github.com/tc39/proposal-cancellation/tree/master/stage0\nimport { arrayWithout } from \"./internal/arrayHelper.js\"\nimport { createCancelError } from \"./cancelError.js\"\n\nexport const createCancellationSource = () => {\n  let requested = false\n  let cancelError\n  let registrationArray = []\n  const cancel = (reason) => {\n    if (requested) return\n    requested = true\n    cancelError = createCancelError(reason)\n\n    const registrationArrayCopy = registrationArray.slice()\n    registrationArray.length = 0\n    registrationArrayCopy.forEach((registration) => {\n      registration.callback(cancelError)\n      // const removedDuringCall = registrationArray.indexOf(registration) === -1\n    })\n  }\n\n  const register = (callback) => {\n    if (typeof callback !== \"function\") {\n      throw new Error(`callback must be a function, got ${callback}`)\n    }\n\n    const existingRegistration = registrationArray.find((registration) => {\n      return registration.callback === callback\n    })\n    // don't register twice\n    if (existingRegistration) {\n      return existingRegistration\n    }\n\n    const registration = {\n      callback,\n      unregister: () => {\n        registrationArray = arrayWithout(registrationArray, registration)\n      },\n    }\n    registrationArray = [registration, ...registrationArray]\n\n    return registration\n  }\n\n  const throwIfRequested = () => {\n    if (requested) {\n      throw cancelError\n    }\n  }\n\n  return {\n    token: {\n      register,\n      get cancellationRequested() {\n        return requested\n      },\n      throwIfRequested,\n    },\n    cancel,\n  }\n}\n",
    "const addCallback = (callback) => {\n  const triggerHangUpOrDeath = () => callback()\n  // SIGHUP http://man7.org/linux/man-pages/man7/signal.7.html\n  process.once(\"SIGUP\", triggerHangUpOrDeath)\n  return () => {\n    process.removeListener(\"SIGUP\", triggerHangUpOrDeath)\n  }\n}\n\nexport const SIGUPSignal = {\n  addCallback,\n}\n",
    "const addCallback = (callback) => {\n  // SIGINT is CTRL+C from keyboard also refered as keyboard interruption\n  // http://man7.org/linux/man-pages/man7/signal.7.html\n  // may also be sent by vscode https://github.com/Microsoft/vscode-node-debug/issues/1#issuecomment-405185642\n  process.once(\"SIGINT\", callback)\n  return () => {\n    process.removeListener(\"SIGINT\", callback)\n  }\n}\n\nexport const SIGINTSignal = {\n  addCallback,\n}\n",
    "const addCallback = (callback) => {\n  if (process.platform === \"win32\") {\n    console.warn(`SIGTERM is not supported on windows`)\n    return () => {}\n  }\n\n  const triggerTermination = () => callback()\n  // SIGTERM http://man7.org/linux/man-pages/man7/signal.7.html\n  process.once(\"SIGTERM\", triggerTermination)\n  return () => {\n    process.removeListener(\"SIGTERM\", triggerTermination)\n  }\n}\n\nexport const SIGTERMSignal = {\n  addCallback,\n}\n",
    "let beforeExitCallbackArray = []\nlet uninstall\nconst addCallback = (callback) => {\n  if (beforeExitCallbackArray.length === 0) uninstall = install()\n  beforeExitCallbackArray = [...beforeExitCallbackArray, callback]\n\n  return () => {\n    if (beforeExitCallbackArray.length === 0) return\n    beforeExitCallbackArray = beforeExitCallbackArray.filter(\n      (beforeExitCallback) => beforeExitCallback !== callback,\n    )\n    if (beforeExitCallbackArray.length === 0) uninstall()\n  }\n}\n\nconst install = () => {\n  const onBeforeExit = () => {\n    return beforeExitCallbackArray.reduce(async (previous, callback) => {\n      await previous\n      return callback()\n    }, Promise.resolve())\n  }\n  process.once(\"beforeExit\", onBeforeExit)\n  return () => {\n    process.removeListener(\"beforeExit\", onBeforeExit)\n  }\n}\n\nexport const beforeExitSignal = {\n  addCallback,\n}\n",
    "const addCallback = (callback, { collectExceptions = false } = {}) => {\n  if (!collectExceptions) {\n    const exitCallback = () => {\n      callback()\n    }\n    process.on(\"exit\", exitCallback)\n    return () => {\n      process.removeListener(\"exit\", exitCallback)\n    }\n  }\n\n  const { getExceptions, stop } = trackExceptions()\n  const exitCallback = () => {\n    process.removeListener(\"exit\", exitCallback)\n    stop()\n    callback({\n      exceptionArray: getExceptions().map(({ exception, origin }) => {\n        return { exception, origin }\n      }),\n    })\n  }\n  process.on(\"exit\", exitCallback)\n  return () => {\n    process.removeListener(\"exit\", exitCallback)\n  }\n}\n\nconst trackExceptions = () => {\n  let exceptionArray = []\n\n  const unhandledRejectionCallback = (unhandledRejection, promise) => {\n    exceptionArray = [\n      ...exceptionArray,\n      { origin: \"unhandledRejection\", exception: unhandledRejection, promise },\n    ]\n  }\n\n  const rejectionHandledCallback = (promise) => {\n    exceptionArray = exceptionArray.filter((exceptionArray) => exceptionArray.promise !== promise)\n  }\n\n  const uncaughtExceptionCallback = (uncaughtException, origin) => {\n    // since node 12.4 https://nodejs.org/docs/latest-v12.x/api/process.html#process_event_uncaughtexception\n    if (origin === \"unhandledRejection\") return\n\n    exceptionArray = [\n      ...exceptionArray,\n      { origin: \"uncaughtException\", exception: uncaughtException },\n    ]\n  }\n\n  process.on(\"unhandledRejection\", unhandledRejectionCallback)\n  process.on(\"rejectionHandled\", rejectionHandledCallback)\n  process.on(\"uncaughtException\", uncaughtExceptionCallback)\n\n  return {\n    getExceptions: () => exceptionArray,\n    stop: () => {\n      process.removeListener(\"unhandledRejection\", unhandledRejectionCallback)\n      process.removeListener(\"rejectionHandled\", rejectionHandledCallback)\n      process.removeListener(\"uncaughtException\", uncaughtExceptionCallback)\n    },\n  }\n}\n\nexport const exitSignal = {\n  addCallback,\n}\n",
    "import { SIGTERMSignal } from \"./SIGTERMSignal.js\"\nimport { SIGINTSignal } from \"./SIGINTSignal.js\"\nimport { SIGUPSignal } from \"./SIGUPSignal.js\"\nimport { beforeExitSignal } from \"./beforeExitSignal.js\"\nimport { exitSignal } from \"./exitSignal.js\"\n\n// usefull to ensure a given server is closed when process stops for instance\nconst addCallback = (callback) => {\n  return eventRace({\n    SIGHUP: {\n      register: SIGUPSignal.addCallback,\n      callback: () => callback(\"SIGHUP\"),\n    },\n    SIGINT: {\n      register: SIGINTSignal.addCallback,\n      callback: () => callback(\"SIGINT\"),\n    },\n    ...(process.platform === \"win32\"\n      ? {}\n      : {\n          SIGTERM: {\n            register: SIGTERMSignal.addCallback,\n            callback: () => callback(\"SIGTERM\"),\n          },\n        }),\n    beforeExit: {\n      register: beforeExitSignal.addCallback,\n      callback: () => callback(\"beforeExit\"),\n    },\n    exit: {\n      register: exitSignal.addCallback,\n      callback: () => callback(\"exit\"),\n    },\n  })\n}\n\nconst eventRace = (eventMap) => {\n  const unregisterMap = {}\n\n  const unregisterAll = (reason) => {\n    return Object.keys(unregisterMap).map((name) => unregisterMap[name](reason))\n  }\n\n  Object.keys(eventMap).forEach((name) => {\n    const { register, callback } = eventMap[name]\n\n    unregisterMap[name] = register((...args) => {\n      unregisterAll()\n      callback(...args)\n    })\n  })\n\n  return unregisterAll\n}\n\nexport const teardownSignal = {\n  addCallback,\n}\n",
    "export const firstOperationMatching = ({ array, start, predicate }) => {\n  if (typeof array !== \"object\") throw new TypeError(createArrayErrorMessage({ array }))\n  if (typeof start !== \"function\") throw new TypeError(createStartErrorMessage({ start }))\n  if (typeof predicate !== \"function\")\n    throw new TypeError(createPredicateErrorMessage({ predicate }))\n\n  return new Promise((resolve, reject) => {\n    const visit = (index) => {\n      if (index >= array.length) {\n        return resolve()\n      }\n      const input = array[index]\n      const returnValue = start(input)\n      return Promise.resolve(returnValue).then((output) => {\n        if (predicate(output)) {\n          return resolve(output)\n        }\n        return visit(index + 1)\n      }, reject)\n    }\n\n    visit(0)\n  })\n}\n\nconst createArrayErrorMessage = ({ array }) => `array must be an object.\narray: ${array}`\n\nconst createStartErrorMessage = ({ start }) => `start must be a function.\nstart: ${start}`\n\nconst createPredicateErrorMessage = ({ predicate }) => `predicate must be a function.\npredicate: ${predicate}`\n",
    "/*\nwhy unadvised ?\n- First because you should not do anything when a process uncaughtException\nor unhandled rejection happens.\nYou cannot assume assume or trust the state of your process so you're\nlikely going to throw an other error trying to handle the first one.\n- Second because the error stack trace will be modified making it harder\nto reach back what cause the error\n\nInstead you should monitor your process with an other one\nand when the monitored process die, here you can do what you want\nlike analysing logs to find what cause process to die, ping a log server, ...\n*/\n\nimport { firstOperationMatching } from \"./internal/firstOperationMatching.js\"\n\nlet recoverCallbackArray = []\nlet uninstall\nconst addCallback = (callback) => {\n  if (recoverCallbackArray.length === 0) uninstall = install()\n  recoverCallbackArray = [...recoverCallbackArray, callback]\n  return () => {\n    if (recoverCallbackArray.length === 0) return\n    recoverCallbackArray = recoverCallbackArray.filter(\n      (recoverCallback) => recoverCallback !== callback,\n    )\n    if (recoverCallbackArray.length === 0) uninstall()\n  }\n}\n\nconst install = () => {\n  const onUncaughtException = (error) => triggerUncaughtException(error)\n\n  const onUnhandledRejection = (value, promise) => triggerUnhandledRejection(value, promise)\n\n  const onRejectionHandled = (promise) =>\n    recoverExceptionMatching((exception) => exception.promise === promise)\n\n  process.on(\"unhandledRejection\", onUnhandledRejection)\n  process.on(\"rejectionHandled\", onRejectionHandled)\n  process.on(\"uncaughtException\", onUncaughtException)\n\n  return () => {\n    process.removeListener(\"unhandledRejection\", onUnhandledRejection)\n    process.removeListener(\"rejectionHandled\", onRejectionHandled)\n    process.removeListener(\"uncaughtException\", onRejectionHandled)\n  }\n}\n\nconst triggerUncaughtException = (error) => crash({ type: \"uncaughtException\", value: error })\n\nconst triggerUnhandledRejection = (value, promise) =>\n  crash({ type: \"unhandledRejection\", value, promise })\n\nlet isCrashing = false\nlet crashReason\nlet resolveRecovering\n\nconst crash = async (reason) => {\n  if (isCrashing) {\n    console.log(`cannot recover due to ${crashReason.type} during recover`)\n    console.error(crashReason.value)\n    resolveRecovering(false)\n    return\n  }\n\n  console.log(`process starts crashing due to ${crashReason.type}`)\n  console.log(`trying to recover`)\n\n  isCrashing = true\n  crashReason = reason\n\n  const externalRecoverPromise = new Promise((resolve) => {\n    resolveRecovering = resolve\n  })\n  const callbackRecoverPromise = firstOperationMatching({\n    array: recoverCallbackArray,\n    start: (recoverCallback) => recoverCallback(reason),\n    predicate: (recovered) => typeof recovered === \"boolean\",\n  })\n  const recoverPromise = Promise.race([externalRecoverPromise, callbackRecoverPromise])\n\n  try {\n    const recovered = await recoverPromise\n    if (recovered) return\n  } catch (error) {\n    console.error(`cannot recover due to internal recover error`)\n    console.error(error)\n  }\n\n  crashReason = undefined\n  // uninstall() prevent catching of the next throw\n  // else the following would create an infinite loop\n  // process.on('uncaughtException', function() {\n  //     setTimeout(function() {\n  //         throw 'yo';\n  //     });\n  // });\n  uninstall()\n  throw reason.value // this mess up the stack trace :'(\n  /* eslint-disable no-unreachable */\n  // the throw above may be catched by other mecanics\n  // so we may arrive there\n  uninstall = install()\n}\n\nconst recoverExceptionMatching = (predicate) => {\n  if (isCrashing && predicate(crashReason)) {\n    resolveRecovering(true)\n  }\n}\n\nexport const unadvisedCrashSignal = {\n  addCallback,\n}\n",
    "import { isCancelError } from \"../cancelError.js\"\n\nexport const wrapFunctionToCatchCancellation = (asyncFunction) => async (...args) => {\n  try {\n    const value = await asyncFunction(...args)\n    return value\n  } catch (error) {\n    if (isCancelError(error)) {\n      // it means consume of the function will resolve with a cancelError\n      // but when you cancel it means you're not interested in the result anymore\n      // thanks to this it avoid unhandledRejection\n      return error\n    }\n    throw error\n  }\n}\n",
    "export const wrapFunctionToConsiderUnhandledRejectionsAsExceptions = (fn) => async (...args) => {\n  const uninstall = installUnhandledRejectionMode()\n  try {\n    const value = await fn(...args)\n    return value\n  } finally {\n    // don't remove it immediatly to let nodejs emit the unhandled rejection\n    setTimeout(() => {\n      uninstall()\n    })\n  }\n}\n\nconst installUnhandledRejectionMode = () => {\n  const unhandledRejectionArg = getCommandArgument(process.execArgv, \"--unhandled-rejections\")\n  if (unhandledRejectionArg === \"strict\") {\n    return () => {}\n  }\n  if (unhandledRejectionArg === \"throw\") {\n    return () => {}\n  }\n\n  const onUnhandledRejection = (reason) => {\n    throw reason\n  }\n  process.once(\"unhandledRejection\", onUnhandledRejection)\n  return () => {\n    console.log(\"remove\")\n    process.removeListener(\"unhandledRejection\", onUnhandledRejection)\n  }\n}\n\nconst getCommandArgument = (argv, name) => {\n  let i = 0\n\n  while (i < argv.length) {\n    const arg = argv[i]\n\n    if (arg === name) {\n      return {\n        name,\n        index: i,\n        value: \"\",\n      }\n    }\n\n    if (arg.startsWith(`${name}=`)) {\n      return {\n        name,\n        index: i,\n        value: arg.slice(`${name}=`.length),\n      }\n    }\n\n    i++\n  }\n\n  return null\n}\n",
    "import { wrapFunctionToCatchCancellation } from \"./internal/wrapFunctionToCatchCancellation.js\"\nimport { wrapFunctionToConsiderUnhandledRejectionsAsExceptions } from \"./internal/wrapFunctionToConsiderUnhandledRejectionsAsExceptions.js\"\n\nexport const executeAsyncFunction = (\n  fn,\n  { catchCancellation = false, considerUnhandledRejectionsAsExceptions = false } = {},\n) => {\n  if (catchCancellation) {\n    fn = wrapFunctionToCatchCancellation(fn)\n  }\n\n  if (considerUnhandledRejectionsAsExceptions) {\n    fn = wrapFunctionToConsiderUnhandledRejectionsAsExceptions(fn)\n  }\n\n  return fn()\n}\n",
    "export const ensureUrlTrailingSlash = (url) => {\n  return url.endsWith(\"/\") ? url : `${url}/`\n}\n",
    "export const isFileSystemPath = (value) => {\n  if (typeof value !== \"string\") {\n    throw new TypeError(`isFileSystemPath first arg must be a string, got ${value}`)\n  }\n\n  if (value[0] === \"/\") return true\n  return startsWithWindowsDriveLetter(value)\n}\n\nconst startsWithWindowsDriveLetter = (string) => {\n  const firstChar = string[0]\n  if (!/[a-zA-Z]/.test(firstChar)) return false\n\n  const secondChar = string[1]\n  if (secondChar !== \":\") return false\n\n  return true\n}\n",
    "import { pathToFileURL } from \"url\"\nimport { isFileSystemPath } from \"./isFileSystemPath.js\"\n\nexport const fileSystemPathToUrl = (value) => {\n  if (!isFileSystemPath(value)) {\n    throw new Error(`received an invalid value for fileSystemPath: ${value}`)\n  }\n  return String(pathToFileURL(value))\n}\n",
    "import { ensureUrlTrailingSlash } from \"./internal/ensureUrlTrailingSlash.js\"\nimport { isFileSystemPath } from \"./isFileSystemPath.js\"\nimport { fileSystemPathToUrl } from \"./fileSystemPathToUrl.js\"\n\nexport const assertAndNormalizeDirectoryUrl = (value) => {\n  let urlString\n\n  if (value instanceof URL) {\n    urlString = value.href\n  } else if (typeof value === \"string\") {\n    if (isFileSystemPath(value)) {\n      urlString = fileSystemPathToUrl(value)\n    } else {\n      try {\n        urlString = String(new URL(value))\n      } catch (e) {\n        throw new TypeError(`directoryUrl must be a valid url, received ${value}`)\n      }\n    }\n  } else {\n    throw new TypeError(`directoryUrl must be a string or an url, received ${value}`)\n  }\n\n  if (!urlString.startsWith(\"file://\")) {\n    throw new Error(`directoryUrl must starts with file://, received ${value}`)\n  }\n\n  return ensureUrlTrailingSlash(urlString)\n}\n",
    "import { isFileSystemPath } from \"./isFileSystemPath.js\"\nimport { fileSystemPathToUrl } from \"./fileSystemPathToUrl.js\"\n\nexport const assertAndNormalizeFileUrl = (value, baseUrl) => {\n  let urlString\n\n  if (value instanceof URL) {\n    urlString = value.href\n  } else if (typeof value === \"string\") {\n    if (isFileSystemPath(value)) {\n      urlString = fileSystemPathToUrl(value)\n    } else {\n      try {\n        urlString = String(new URL(value, baseUrl))\n      } catch (e) {\n        throw new TypeError(`fileUrl must be a valid url, received ${value}`)\n      }\n    }\n  } else {\n    throw new TypeError(`fileUrl must be a string or an url, received ${value}`)\n  }\n\n  if (!urlString.startsWith(\"file://\")) {\n    throw new Error(`fileUrl must starts with file://, received ${value}`)\n  }\n\n  return urlString\n}\n",
    "import { fileURLToPath } from \"url\"\n\nexport const urlToFileSystemPath = (fileUrl) => {\n  if (fileUrl[fileUrl.length - 1] === \"/\") {\n    // remove trailing / so that nodejs path becomes predictable otherwise it logs\n    // the trailing slash on linux but does not on windows\n    fileUrl = fileUrl.slice(0, -1)\n  }\n  const fileSystemPath = fileURLToPath(fileUrl)\n  return fileSystemPath\n}\n",
    "import { lstat, stat } from \"fs\"\nimport { assertAndNormalizeFileUrl } from \"./assertAndNormalizeFileUrl.js\"\nimport { urlToFileSystemPath } from \"./urlToFileSystemPath.js\"\nimport { writeFileSystemNodePermissions } from \"./writeFileSystemNodePermissions.js\"\n\nconst isWindows = process.platform === \"win32\"\n\nexport const readFileSystemNodeStat = async (\n  source,\n  { nullIfNotFound = false, followLink = true } = {},\n) => {\n  if (source.endsWith(\"/\")) source = source.slice(0, -1)\n\n  const sourceUrl = assertAndNormalizeFileUrl(source)\n  const sourcePath = urlToFileSystemPath(sourceUrl)\n\n  const handleNotFoundOption = nullIfNotFound\n    ? {\n        handleNotFoundError: () => null,\n      }\n    : {}\n\n  return readStat(sourcePath, {\n    followLink,\n    ...handleNotFoundOption,\n    ...(isWindows\n      ? {\n          // Windows can EPERM on stat\n          handlePermissionDeniedError: async (error) => {\n            console.error(`trying to fix windows EPERM after stats on ${sourcePath}`)\n\n            try {\n              // unfortunately it means we mutate the permissions\n              // without being able to restore them to the previous value\n              // (because reading current permission would also throw)\n              await writeFileSystemNodePermissions(sourceUrl, 0o666)\n              const stats = await readStat(sourcePath, {\n                followLink,\n                ...handleNotFoundOption,\n                // could not fix the permission error, give up and throw original error\n                handlePermissionDeniedError: () => {\n                  console.error(`still got EPERM after stats on ${sourcePath}`)\n                  throw error\n                },\n              })\n              return stats\n            } catch (e) {\n              console.error(\n                `error while trying to fix windows EPERM after stats on ${sourcePath}: ${e.stack}`,\n              )\n              throw error\n            }\n          },\n        }\n      : {}),\n  })\n}\n\nconst readStat = (\n  sourcePath,\n  { followLink, handleNotFoundError = null, handlePermissionDeniedError = null } = {},\n) => {\n  const nodeMethod = followLink ? stat : lstat\n\n  return new Promise((resolve, reject) => {\n    nodeMethod(sourcePath, (error, statsObject) => {\n      if (error) {\n        if (handleNotFoundError && error.code === \"ENOENT\") {\n          resolve(handleNotFoundError(error))\n        } else if (\n          handlePermissionDeniedError &&\n          (error.code === \"EPERM\" || error.code === \"EACCES\")\n        ) {\n          resolve(handlePermissionDeniedError(error))\n        } else {\n          reject(error)\n        }\n      } else {\n        resolve(statsObject)\n      }\n    })\n  })\n}\n",
    "import { createHash } from \"crypto\"\n\nconst ETAG_FOR_EMPTY_CONTENT = '\"0-2jmj7l5rSw0yVb/vlWAYkK/YBwk\"'\n\nexport const bufferToEtag = (buffer) => {\n  if (!Buffer.isBuffer(buffer)) {\n    throw new TypeError(`buffer expected, got ${buffer}`)\n  }\n\n  if (buffer.length === 0) {\n    return ETAG_FOR_EMPTY_CONTENT\n  }\n\n  const hash = createHash(\"sha1\")\n  hash.update(buffer, \"utf8\")\n\n  const hashBase64String = hash.digest(\"base64\")\n  const hashBase64StringSubset = hashBase64String.slice(0, 27)\n  const length = buffer.length\n\n  return `\"${length.toString(16)}-${hashBase64StringSubset}\"`\n}\n",
    "import { readdir } from \"fs\"\nimport { assertAndNormalizeDirectoryUrl } from \"./assertAndNormalizeDirectoryUrl.js\"\nimport { urlToFileSystemPath } from \"./urlToFileSystemPath.js\"\n\nexport const readDirectory = async (url, { emfileMaxWait = 1000 } = {}) => {\n  const directoryUrl = assertAndNormalizeDirectoryUrl(url)\n  const directoryPath = urlToFileSystemPath(directoryUrl)\n  const startMs = Date.now()\n  let attemptCount = 0\n\n  const attempt = () => {\n    return readdirNaive(directoryPath, {\n      handleTooManyFilesOpenedError: async (error) => {\n        attemptCount++\n        const nowMs = Date.now()\n        const timeSpentWaiting = nowMs - startMs\n        if (timeSpentWaiting > emfileMaxWait) {\n          throw error\n        }\n\n        return new Promise((resolve) => {\n          setTimeout(() => {\n            resolve(attempt())\n          }, attemptCount)\n        })\n      },\n    })\n  }\n\n  return attempt()\n}\n\nconst readdirNaive = (directoryPath, { handleTooManyFilesOpenedError = null } = {}) => {\n  return new Promise((resolve, reject) => {\n    readdir(directoryPath, (error, names) => {\n      if (error) {\n        // https://nodejs.org/dist/latest-v13.x/docs/api/errors.html#errors_common_system_errors\n        if (handleTooManyFilesOpenedError && (error.code === \"EMFILE\" || error.code === \"ENFILE\")) {\n          resolve(handleTooManyFilesOpenedError(error))\n        } else {\n          reject(error)\n        }\n      } else {\n        resolve(names)\n      }\n    })\n  })\n}\n",
    "import { fileSystemPathToUrl } from \"./fileSystemPathToUrl.js\"\n\nconst isWindows = process.platform === \"win32\"\nconst baseUrlFallback = fileSystemPathToUrl(process.cwd())\n\n/**\n * Some url might be resolved or remapped to url without the windows drive letter.\n * For instance\n * new URL('/foo.js', 'file:///C:/dir/file.js')\n * resolves to\n * 'file:///foo.js'\n *\n * But on windows it becomes a problem because we need the drive letter otherwise\n * url cannot be converted to a filesystem path.\n *\n * ensureWindowsDriveLetter ensure a resolved url still contains the drive letter.\n */\n\nexport const ensureWindowsDriveLetter = (url, baseUrl) => {\n  try {\n    url = String(new URL(url))\n  } catch (e) {\n    throw new Error(`absolute url expected but got ${url}`)\n  }\n\n  if (!isWindows) {\n    return url\n  }\n\n  try {\n    baseUrl = String(new URL(baseUrl))\n  } catch (e) {\n    throw new Error(\n      `absolute baseUrl expected but got ${baseUrl} to ensure windows drive letter on ${url}`,\n    )\n  }\n\n  if (!url.startsWith(\"file://\")) {\n    return url\n  }\n  const afterProtocol = url.slice(\"file://\".length)\n  // we still have the windows drive letter\n  if (extractDriveLetter(afterProtocol)) {\n    return url\n  }\n\n  // drive letter was lost, restore it\n  const baseUrlOrFallback = baseUrl.startsWith(\"file://\") ? baseUrl : baseUrlFallback\n  const driveLetter = extractDriveLetter(baseUrlOrFallback.slice(\"file://\".length))\n  if (!driveLetter) {\n    throw new Error(\n      `drive letter expected on baseUrl but got ${baseUrl} to ensure windows drive letter on ${url}`,\n    )\n  }\n  return `file:///${driveLetter}:${afterProtocol}`\n}\n\nconst extractDriveLetter = (ressource) => {\n  // we still have the windows drive letter\n  if (/[a-zA-Z]/.test(ressource[1]) && ressource[2] === \":\") {\n    return ressource[1]\n  }\n  return null\n}\n",
    "import { promises } from \"fs\"\nimport { assertAndNormalizeFileUrl } from \"./assertAndNormalizeFileUrl.js\"\nimport { urlToFileSystemPath } from \"./urlToFileSystemPath.js\"\nimport { resolveUrl } from \"./resolveUrl.js\"\nimport { isFileSystemPath } from \"./isFileSystemPath.js\"\nimport { ensureParentDirectories } from \"./ensureParentDirectories.js\"\nimport { readFileSystemNodeStat } from \"./readFileSystemNodeStat.js\"\n\n// https://nodejs.org/dist/latest-v13.x/docs/api/fs.html#fs_fspromises_symlink_target_path_type\nconst { symlink } = promises\nconst isWindows = process.platform === \"win32\"\n\nexport const writeSymbolicLink = async (destination, target, { type } = {}) => {\n  const destinationUrl = assertAndNormalizeFileUrl(destination)\n\n  let targetValue\n  if (typeof target === \"string\") {\n    // absolute filesystem path\n    if (isFileSystemPath(target)) {\n      targetValue = target\n    }\n    // relative url\n    else if (target.startsWith(\"./\") || target.startsWith(\"../\")) {\n      targetValue = target\n    }\n    // absolute url\n    else {\n      const targetUrl = String(new URL(target, destinationUrl))\n      targetValue = urlToFileSystemPath(targetUrl)\n    }\n  } else if (target instanceof URL) {\n    targetValue = urlToFileSystemPath(target)\n  } else {\n    throw new TypeError(`symbolic link target must be a string or an url, received ${target}`)\n  }\n\n  if (isWindows && typeof type !== \"string\") {\n    // without this if you write a symbolic link without specifying the type on windows\n    // you later get EPERM when doing stat on the symlink\n    const targetUrl = resolveUrl(targetValue, destinationUrl)\n    const targetStats = await readFileSystemNodeStat(targetUrl, { nullIfNotFound: true })\n    type = targetStats && targetStats.isDirectory() ? \"dir\" : \"file\"\n  }\n\n  const symbolicLinkPath = urlToFileSystemPath(destinationUrl)\n  try {\n    await symlink(targetValue, symbolicLinkPath, type)\n  } catch (error) {\n    if (error.code === \"ENOENT\") {\n      await ensureParentDirectories(destinationUrl)\n      await symlink(targetValue, symbolicLinkPath, type)\n      return\n    }\n    throw error\n  }\n}\n",
    "export const memoize = (compute) => {\n  let memoized = false\n  let memoizedValue\n\n  const fnWithMemoization = (...args) => {\n    if (memoized) {\n      return memoizedValue\n    }\n    // if compute is recursive wait for it to be fully done before storing the value\n    // so set memoized boolean after the call\n    memoizedValue = compute(...args)\n    memoized = true\n    return memoizedValue\n  }\n\n  fnWithMemoization.forget = () => {\n    const value = memoizedValue\n    memoized = false\n    memoizedValue = undefined\n    return value\n  }\n\n  return fnWithMemoization\n}\n",
    "import { promisify } from \"util\"\nimport { readFile as readFileNode } from \"fs\"\nimport { assertAndNormalizeFileUrl } from \"./assertAndNormalizeFileUrl.js\"\nimport { urlToFileSystemPath } from \"./urlToFileSystemPath.js\"\n\nconst readFilePromisified = promisify(readFileNode)\nexport const readFile = async (value, { as = \"string\" } = {}) => {\n  const fileUrl = assertAndNormalizeFileUrl(value)\n  const filePath = urlToFileSystemPath(fileUrl)\n  const buffer = await readFilePromisified(filePath)\n  if (as === \"buffer\") {\n    return buffer\n  }\n  if (as === \"string\") {\n    return buffer.toString()\n  }\n  if (as === \"json\") {\n    return JSON.parse(buffer.toString())\n  }\n  throw new Error(`as must be one of buffer,string,json, received ${as}.`)\n}\n",
    "import { watch, openSync, closeSync } from \"fs\"\n\nconst isWindows = process.platform === \"win32\"\n\nexport const createWatcher = (sourcePath, options) => {\n  const watcher = watch(sourcePath, options)\n\n  if (isWindows) {\n    watcher.on(\"error\", async (error) => {\n      // https://github.com/joyent/node/issues/4337\n      if (error.code === \"EPERM\") {\n        try {\n          const fd = openSync(sourcePath, \"r\")\n          closeSync(fd)\n        } catch (e) {\n          if (e.code === \"ENOENT\") {\n            return\n          }\n          console.error(`error while fixing windows eperm: ${e.stack}`)\n          throw error\n        }\n      } else {\n        throw error\n      }\n    })\n  }\n\n  return watcher\n}\n",
    "/* eslint-disable import/max-dependencies */\nimport { readdirSync } from \"fs\"\nimport {\n  metaMapToSpecifierMetaMap,\n  normalizeSpecifierMetaMap,\n  urlCanContainsMetaMatching,\n  urlToMeta,\n} from \"@jsenv/url-meta\"\nimport { replaceBackSlashesWithSlashes } from \"./internal/replaceBackSlashesWithSlashes.js\"\nimport { fileSystemNodeToTypeOrNull } from \"./internal/fileSystemNodeToTypeOrNull.js\"\nimport { createWatcher } from \"./internal/createWatcher.js\"\nimport { trackRessources } from \"./internal/trackRessources.js\"\nimport { ensureUrlTrailingSlash } from \"./internal/ensureUrlTrailingSlash.js\"\nimport { resolveUrl } from \"./resolveUrl.js\"\nimport { assertAndNormalizeFileUrl } from \"./assertAndNormalizeFileUrl.js\"\nimport { urlToFileSystemPath } from \"./urlToFileSystemPath.js\"\nimport { urlToRelativeUrl } from \"./urlToRelativeUrl.js\"\n\nconst isLinux = process.platform === \"linux\"\n// linux does not support recursive option\nconst fsWatchSupportsRecursive = !isLinux\n\nexport const registerDirectoryLifecycle = (\n  source,\n  {\n    added,\n    updated,\n    removed,\n    watchDescription = {\n      \"./**/*\": true,\n    },\n    notifyExistent = false,\n    keepProcessAlive = true,\n    recursive = false,\n  },\n) => {\n  const sourceUrl = ensureUrlTrailingSlash(assertAndNormalizeFileUrl(source))\n  if (!undefinedOrFunction(added)) {\n    throw new TypeError(`added must be a function or undefined, got ${added}`)\n  }\n  if (!undefinedOrFunction(updated)) {\n    throw new TypeError(`updated must be a function or undefined, got ${updated}`)\n  }\n  if (!undefinedOrFunction(removed)) {\n    throw new TypeError(`removed must be a function or undefined, got ${removed}`)\n  }\n\n  const specifierMetaMap = normalizeSpecifierMetaMap(\n    metaMapToSpecifierMetaMap({\n      watch: watchDescription,\n    }),\n    sourceUrl,\n  )\n  const entryShouldBeWatched = ({ relativeUrl, type }) => {\n    const entryUrl = resolveUrl(relativeUrl, sourceUrl)\n\n    if (type === \"directory\") {\n      const canContainEntryToWatch = urlCanContainsMetaMatching({\n        url: `${entryUrl}/`,\n        specifierMetaMap,\n        predicate: ({ watch }) => watch,\n      })\n      return canContainEntryToWatch\n    }\n\n    const entryMeta = urlToMeta({\n      url: entryUrl,\n      specifierMetaMap,\n    })\n\n    return entryMeta.watch\n  }\n\n  const tracker = trackRessources()\n\n  const contentMap = new Map()\n\n  const handleDirectoryEvent = ({ directoryRelativeUrl, filename, eventType }) => {\n    if (filename) {\n      if (directoryRelativeUrl) {\n        handleChange(`${directoryRelativeUrl}/${filename}`)\n      } else {\n        handleChange(`${filename}`)\n      }\n    } else if ((removed || added) && eventType === \"rename\") {\n      // we might receive `rename` without filename\n      // in that case we try to find ourselves which file was removed.\n\n      let relativeUrlCandidateArray = Array.from(contentMap.keys())\n\n      if (recursive && !fsWatchSupportsRecursive) {\n        relativeUrlCandidateArray = relativeUrlCandidateArray.filter((relativeUrlCandidate) => {\n          if (!directoryRelativeUrl) {\n            // ensure entry is top level\n            if (relativeUrlCandidate.includes(\"/\")) return false\n            return true\n          }\n\n          // entry not inside this directory\n          if (!relativeUrlCandidate.startsWith(directoryRelativeUrl)) return false\n\n          const afterDirectory = relativeUrlCandidate.slice(directoryRelativeUrl.length + 1)\n          // deep inside this directory\n          if (afterDirectory.includes(\"/\")) return false\n\n          return true\n        })\n      }\n\n      const removedEntryRelativeUrl = relativeUrlCandidateArray.find((relativeUrlCandidate) => {\n        const entryUrl = resolveUrl(relativeUrlCandidate, sourceUrl)\n        const type = fileSystemNodeToTypeOrNull(entryUrl)\n        return type === null\n      })\n\n      if (removedEntryRelativeUrl) {\n        handleEntryLost({\n          relativeUrl: removedEntryRelativeUrl,\n          type: contentMap.get(removedEntryRelativeUrl),\n        })\n      }\n    }\n  }\n\n  const handleChange = (relativeUrl) => {\n    const entryUrl = resolveUrl(relativeUrl, sourceUrl)\n    const previousType = contentMap.get(relativeUrl)\n    const type = fileSystemNodeToTypeOrNull(entryUrl)\n\n    if (!entryShouldBeWatched({ relativeUrl, type })) {\n      return\n    }\n\n    // it's something new\n    if (!previousType) {\n      if (type !== null) {\n        handleEntryFound({ relativeUrl, type, existent: false })\n      }\n      return\n    }\n\n    // it existed but now it's not here anymore\n    if (type === null) {\n      handleEntryLost({ relativeUrl, type: previousType })\n      return\n    }\n\n    // it existed and was replaced by something else\n    // we don't handle this as an update. We rather say the ressource\n    // is lost and something else is found (call removed() then added())\n    if (previousType !== type) {\n      handleEntryLost({ relativeUrl, type: previousType })\n      handleEntryFound({ relativeUrl, type })\n      return\n    }\n\n    // a directory cannot really be updated in way that matters for us\n    // filesystem is trying to tell us the directory content have changed\n    // but we don't care about that\n    // we'll already be notified about what has changed\n    if (type === \"directory\") {\n      return\n    }\n\n    // something has changed at this relativeUrl (the file existed and was not deleted)\n    // it's possible to get there and there is no real update\n    // (file content is the same and file mtime is the same).\n    // In short filesystem is sometimes \"lying\"\n    // Not trying to guard against that because:\n    // - hurt perfs a lot\n    // - it happens very rarely\n    // - it's not really a concern in practice\n    // - filesystem did not send an event out of nowhere:\n    // something occured but we don't know what with the information we have.\n    if (updated) {\n      updated({ relativeUrl, type })\n    }\n  }\n\n  const handleEntryFound = ({ relativeUrl, type, existent }) => {\n    if (!entryShouldBeWatched({ relativeUrl, type })) {\n      return\n    }\n\n    contentMap.set(relativeUrl, type)\n\n    const entryUrl = resolveUrl(relativeUrl, sourceUrl)\n\n    if (type === \"directory\") {\n      visitDirectory({\n        directoryUrl: `${entryUrl}/`,\n        entryFound: (entry) => {\n          handleEntryFound({\n            relativeUrl: `${relativeUrl}/${entry.relativeUrl}`,\n            type: entry.type,\n            existent,\n          })\n        },\n      })\n    }\n\n    if (added) {\n      if (existent) {\n        if (notifyExistent) {\n          added({ relativeUrl, type, existent: true })\n        }\n      } else {\n        added({ relativeUrl, type })\n      }\n    }\n\n    // we must watch manually every directory we find\n    if (!fsWatchSupportsRecursive && type === \"directory\") {\n      const watcher = createWatcher(urlToFileSystemPath(entryUrl), { persistent: keepProcessAlive })\n      tracker.registerCleanupCallback(() => {\n        watcher.close()\n      })\n      watcher.on(\"change\", (eventType, filename) => {\n        handleDirectoryEvent({\n          directoryRelativeUrl: relativeUrl,\n          filename: filename ? replaceBackSlashesWithSlashes(filename) : \"\",\n          eventType,\n        })\n      })\n    }\n  }\n\n  const handleEntryLost = ({ relativeUrl, type }) => {\n    contentMap.delete(relativeUrl)\n    if (removed) {\n      removed({ relativeUrl, type })\n    }\n  }\n\n  visitDirectory({\n    directoryUrl: sourceUrl,\n    entryFound: ({ relativeUrl, type }) => {\n      handleEntryFound({ relativeUrl, type, existent: true })\n    },\n  })\n\n  const watcher = createWatcher(urlToFileSystemPath(sourceUrl), {\n    recursive: recursive && fsWatchSupportsRecursive,\n    persistent: keepProcessAlive,\n  })\n  tracker.registerCleanupCallback(() => {\n    watcher.close()\n  })\n  watcher.on(\"change\", (eventType, fileSystemPath) => {\n    handleDirectoryEvent({\n      ...fileSystemPathToDirectoryRelativeUrlAndFilename(fileSystemPath),\n      eventType,\n    })\n  })\n\n  return tracker.cleanup\n}\n\nconst undefinedOrFunction = (value) => typeof value === \"undefined\" || typeof value === \"function\"\n\nconst visitDirectory = ({ directoryUrl, entryFound }) => {\n  const directoryPath = urlToFileSystemPath(directoryUrl)\n  readdirSync(directoryPath).forEach((entry) => {\n    const entryUrl = resolveUrl(entry, directoryUrl)\n    const type = fileSystemNodeToTypeOrNull(entryUrl)\n    if (type === null) {\n      return\n    }\n\n    const relativeUrl = urlToRelativeUrl(entryUrl, directoryUrl)\n    entryFound({\n      relativeUrl,\n      type,\n    })\n  })\n}\n\nconst fileSystemPathToDirectoryRelativeUrlAndFilename = (path) => {\n  if (!path) {\n    return {\n      directoryRelativeUrl: \"\",\n      filename: \"\",\n    }\n  }\n\n  const normalizedPath = replaceBackSlashesWithSlashes(path)\n  const slashLastIndex = normalizedPath.lastIndexOf(\"/\")\n  if (slashLastIndex === -1) {\n    return {\n      directoryRelativeUrl: \"\",\n      filename: normalizedPath,\n    }\n  }\n\n  const directoryRelativeUrl = normalizedPath.slice(0, slashLastIndex)\n  const filename = normalizedPath.slice(slashLastIndex + 1)\n  return {\n    directoryRelativeUrl,\n    filename,\n  }\n}\n",
    "import { performance } from \"perf_hooks\"\n\nexport const timeStart = (name) => {\n  // as specified in https://w3c.github.io/server-timing/#the-performanceservertiming-interface\n  // duration is a https://www.w3.org/TR/hr-time-2/#sec-domhighrestimestamp\n  const startTimestamp = performance.now()\n  const timeEnd = () => {\n    const endTimestamp = performance.now()\n    const timing = {\n      [name]: endTimestamp - startTimestamp,\n    }\n    return timing\n  }\n  return timeEnd\n}\n\nexport const timeFunction = (name, fn) => {\n  const timeEnd = timeStart(name)\n  const returnValue = fn()\n  if (returnValue && typeof returnValue.then === \"function\") {\n    return returnValue.then((value) => {\n      return [timeEnd(), value]\n    })\n  }\n  return [timeEnd(), returnValue]\n}\n\n// to predict order in chrome devtools we should put a,b,c,d,e or something\n// because in chrome dev tools they are shown in alphabetic order\n// also we should manipulate a timing object instead of a header to facilitate\n// manipulation of the object so that the timing header response generation logic belongs to @jsenv/server\n// so response can return a new timing object\n// yes it's awful, feel free to PR with a better approach :)\nexport const timingToServerTimingResponseHeaders = (timing) => {\n  const serverTimingValue = Object.keys(timing)\n    .map((key, index) => {\n      const time = timing[key]\n      return `${letters[index] || \"zz\"};desc=\"${key}\";dur=${time}`\n    })\n    .join(\", \")\n\n  return { \"server-timing\": serverTimingValue }\n}\n\nconst letters = [\n  \"a\",\n  \"b\",\n  \"c\",\n  \"d\",\n  \"e\",\n  \"f\",\n  \"g\",\n  \"h\",\n  \"i\",\n  \"j\",\n  \"k\",\n  \"l\",\n  \"m\",\n  \"n\",\n  \"o\",\n  \"p\",\n  \"q\",\n  \"r\",\n  \"s\",\n  \"t\",\n]\n",
    "export const jsenvContentTypeMap = {\n  \"application/javascript\": {\n    extensions: [\"js\", \"cjs\", \"mjs\", \"ts\", \"jsx\"],\n  },\n  \"application/json\": {\n    extensions: [\"json\"],\n  },\n  \"application/importmap+json\": {\n    extensions: [\"importmap\"],\n  },\n  \"application/octet-stream\": {},\n  \"application/pdf\": {\n    extensions: [\"pdf\"],\n  },\n  \"application/xml\": {\n    extensions: [\"xml\"],\n  },\n  \"application/x-gzip\": {\n    extensions: [\"gz\"],\n  },\n  \"application/wasm\": {\n    extensions: [\"wasm\"],\n  },\n  \"application/zip\": {\n    extensions: [\"zip\"],\n  },\n  \"audio/basic\": {\n    extensions: [\"au\", \"snd\"],\n  },\n  \"audio/mpeg\": {\n    extensions: [\"mpga\", \"mp2\", \"mp2a\", \"mp3\", \"m2a\", \"m3a\"],\n  },\n  \"audio/midi\": {\n    extensions: [\"midi\", \"mid\", \"kar\", \"rmi\"],\n  },\n  \"audio/mp4\": {\n    extensions: [\"m4a\", \"mp4a\"],\n  },\n  \"audio/ogg\": {\n    extensions: [\"oga\", \"ogg\", \"spx\"],\n  },\n  \"audio/webm\": {\n    extensions: [\"weba\"],\n  },\n  \"audio/x-wav\": {\n    extensions: [\"wav\"],\n  },\n  \"font/ttf\": {\n    extensions: [\"ttf\"],\n  },\n  \"font/woff\": {\n    extensions: [\"woff\"],\n  },\n  \"font/woff2\": {\n    extensions: [\"woff2\"],\n  },\n  \"image/png\": {\n    extensions: [\"png\"],\n  },\n  \"image/gif\": {\n    extensions: [\"gif\"],\n  },\n  \"image/jpeg\": {\n    extensions: [\"jpg\"],\n  },\n  \"image/svg+xml\": {\n    extensions: [\"svg\", \"svgz\"],\n  },\n  \"text/plain\": {\n    extensions: [\"txt\"],\n  },\n  \"text/html\": {\n    extensions: [\"html\"],\n  },\n  \"text/css\": {\n    extensions: [\"css\"],\n  },\n  \"text/cache-manifest\": {\n    extensions: [\"appcache\"],\n  },\n  \"video/mp4\": {\n    extensions: [\"mp4\", \"mp4v\", \"mpg4\"],\n  },\n  \"video/mpeg\": {\n    extensions: [\"mpeg\", \"mpg\", \"mpe\", \"m1v\", \"m2v\"],\n  },\n  \"video/ogg\": {\n    extensions: [\"ogv\"],\n  },\n  \"video/webm\": {\n    extensions: [\"webm\"],\n  },\n}\n",
    "// https://github.com/jshttp/mime-db/blob/master/src/apache-types.json\n\nimport { extname } from \"path\"\nimport { jsenvContentTypeMap } from \"./jsenvContentTypeMap.js\"\n\nexport const urlToContentType = (\n  url,\n  contentTypeMap = jsenvContentTypeMap,\n  contentTypeDefault = \"application/octet-stream\",\n) => {\n  if (typeof contentTypeMap !== \"object\") {\n    throw new TypeError(`contentTypeMap must be an object, got ${contentTypeMap}`)\n  }\n  const pathname = new URL(url).pathname\n\n  const extensionWithDot = extname(pathname)\n\n  if (!extensionWithDot || extensionWithDot === \".\") {\n    return contentTypeDefault\n  }\n\n  const extension = extensionWithDot.slice(1)\n  const availableContentTypes = Object.keys(contentTypeMap)\n  const contentTypeForExtension = availableContentTypes.find((contentTypeName) => {\n    const contentType = contentTypeMap[contentTypeName]\n    return contentType.extensions && contentType.extensions.indexOf(extension) > -1\n  })\n  return contentTypeForExtension || contentTypeDefault\n}\n",
    "import { createReadStream, promises, statSync } from \"fs\"\nimport {\n  bufferToEtag,\n  assertAndNormalizeFileUrl,\n  readDirectory,\n  urlToFileSystemPath,\n} from \"@jsenv/util\"\nimport { createCancellationToken, createOperation } from \"@jsenv/cancellation\"\nimport { timeFunction } from \"./serverTiming.js\"\nimport { convertFileSystemErrorToResponseProperties } from \"./convertFileSystemErrorToResponseProperties.js\"\nimport { urlToContentType } from \"./urlToContentType.js\"\nimport { jsenvContentTypeMap } from \"./jsenvContentTypeMap.js\"\nimport { composeResponse } from \"./composeResponse.js\"\n\nconst { readFile } = promises\n\nconst ETAG_CACHE = new Map()\nconst ETAG_CACHE_MAX_SIZE = 500\n\nexport const serveFile = async (\n  source,\n  {\n    cancellationToken = createCancellationToken(),\n    method = \"GET\",\n    headers = {},\n    contentTypeMap = jsenvContentTypeMap,\n    etagEnabled = false,\n    etagCacheDisabled = false,\n    mtimeEnabled = false,\n    cacheControl = etagEnabled || mtimeEnabled ? \"private,max-age=0,must-revalidate\" : \"no-store\",\n    canReadDirectory = false,\n    readableStreamLifetimeInSeconds = 5,\n  } = {},\n) => {\n  // here you might be tempted to add || cacheControl === 'no-cache'\n  // but no-cache means ressource can be cache but must be revalidated (yeah naming is strange)\n  // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#Cacheability\n  if (cacheControl === \"no-store\") {\n    if (etagEnabled) {\n      console.warn(`cannot enable etag when cache-control is ${cacheControl}`)\n      etagEnabled = false\n    }\n    if (mtimeEnabled) {\n      console.warn(`cannot enable mtime when cache-control is ${cacheControl}`)\n      mtimeEnabled = false\n    }\n  }\n  if (etagEnabled && mtimeEnabled) {\n    console.warn(`cannot enable both etag and mtime, mtime disabled in favor of etag.`)\n    mtimeEnabled = false\n  }\n\n  if (method !== \"GET\" && method !== \"HEAD\") {\n    return {\n      status: 501,\n    }\n  }\n\n  const sourceUrl = assertAndNormalizeFileUrl(source)\n\n  try {\n    const [readStatTiming, sourceStat] = await timeFunction(\"file service>read file stat\", () =>\n      statSync(urlToFileSystemPath(sourceUrl)),\n    )\n\n    const clientCacheResponse = await getClientCacheResponse({\n      cancellationToken,\n      etagEnabled,\n      etagCacheDisabled,\n      mtimeEnabled,\n      method,\n      headers,\n      sourceStat,\n      sourceUrl,\n    })\n\n    // send 304 (redirect response to client cache)\n    // because the response body does not have to be transmitted\n    if (clientCacheResponse.status === 304) {\n      return composeResponse(\n        {\n          timing: readStatTiming,\n          headers: {\n            ...(cacheControl ? { \"cache-control\": cacheControl } : {}),\n          },\n        },\n        clientCacheResponse,\n      )\n    }\n\n    const rawResponse = await getRawResponse({\n      cancellationToken,\n      canReadDirectory,\n      contentTypeMap,\n      method,\n      headers,\n      sourceStat,\n      sourceUrl,\n    })\n\n    // do not keep readable stream opened on that file\n    // otherwise file is kept open forever.\n    // moreover it will prevent to unlink the file on windows.\n    if (clientCacheResponse.body) {\n      rawResponse.body.destroy()\n    } else if (readableStreamLifetimeInSeconds && readableStreamLifetimeInSeconds !== Infinity) {\n      // safe measure, ensure the readable stream gets used in the next ${readableStreamLifetimeInSeconds} otherwise destroys it\n      const timeout = setTimeout(() => {\n        console.warn(\n          `readable stream on ${sourceUrl} still unused after ${readableStreamLifetimeInSeconds} seconds -> destroying it to release file handle`,\n        )\n        rawResponse.body.destroy()\n      }, readableStreamLifetimeInSeconds * 1000)\n      onceReadableStreamUsedOrClosed(rawResponse.body, () => {\n        clearTimeout(timeout)\n      })\n    }\n\n    return composeResponse(\n      {\n        timing: readStatTiming,\n        headers: {\n          ...(cacheControl ? { \"cache-control\": cacheControl } : {}),\n          // even if client cache is disabled, server can still\n          // send his own cache control but client should just ignore it\n          // and keep sending cache-control: 'no-store'\n          // if not, uncomment the line below to preserve client\n          // desire to ignore cache\n          // ...(headers[\"cache-control\"] === \"no-store\" ? { \"cache-control\": \"no-store\" } : {}),\n        },\n      },\n      rawResponse,\n      clientCacheResponse,\n    )\n  } catch (e) {\n    return convertFileSystemErrorToResponseProperties(e)\n  }\n}\n\nconst getClientCacheResponse = async ({\n  headers,\n  etagEnabled,\n  etagCacheDisabled,\n  mtimeEnabled,\n  ...rest\n}) => {\n  // here you might be tempted to add || headers[\"cache-control\"] === \"no-cache\"\n  // but no-cache means ressource can be cache but must be revalidated (yeah naming is strange)\n  // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#Cacheability\n\n  if (\n    headers[\"cache-control\"] === \"no-store\" ||\n    // let's disable it on no-cache too (https://github.com/jsenv/jsenv-server/issues/17)\n    headers[\"cache-control\"] === \"no-cache\"\n  ) {\n    return { status: 200 }\n  }\n\n  if (etagEnabled) {\n    return getEtagResponse({\n      etagCacheDisabled,\n      headers,\n      ...rest,\n    })\n  }\n\n  if (mtimeEnabled) {\n    return getMtimeResponse({\n      headers,\n      ...rest,\n    })\n  }\n\n  return { status: 200 }\n}\n\nconst getEtagResponse = async ({\n  etagCacheDisabled,\n  cancellationToken,\n  sourceUrl,\n  sourceStat,\n  headers,\n}) => {\n  const [computeEtagTiming, fileContentEtag] = await timeFunction(\n    \"file service>generate file etag\",\n    () => computeEtag({ cancellationToken, etagCacheDisabled, headers, sourceUrl, sourceStat }),\n  )\n\n  const requestHasIfNoneMatchHeader = \"if-none-match\" in headers\n  if (requestHasIfNoneMatchHeader && headers[\"if-none-match\"] === fileContentEtag) {\n    return {\n      status: 304,\n      timing: computeEtagTiming,\n    }\n  }\n\n  return {\n    status: 200,\n    headers: {\n      etag: fileContentEtag,\n    },\n    timing: computeEtagTiming,\n  }\n}\n\nconst computeEtag = async ({ cancellationToken, etagCacheDisabled, sourceUrl, sourceStat }) => {\n  if (!etagCacheDisabled) {\n    const etagCacheEntry = ETAG_CACHE.get(sourceUrl)\n    if (etagCacheEntry && fileStatAreTheSame(etagCacheEntry.sourceStat, sourceStat)) {\n      return etagCacheEntry.eTag\n    }\n  }\n  const fileContentAsBuffer = await createOperation({\n    cancellationToken,\n    start: () => readFile(urlToFileSystemPath(sourceUrl)),\n  })\n  const eTag = bufferToEtag(fileContentAsBuffer)\n  if (!etagCacheDisabled) {\n    if (ETAG_CACHE.size >= ETAG_CACHE_MAX_SIZE) {\n      const firstKey = Array.from(ETAG_CACHE.keys())[0]\n      ETAG_CACHE.delete(firstKey)\n    }\n    ETAG_CACHE.set(sourceUrl, { sourceStat, eTag })\n  }\n  return eTag\n}\n\n// https://nodejs.org/api/fs.html#fs_class_fs_stats\nconst fileStatAreTheSame = (leftFileStat, rightFileStat) => {\n  return fileStatKeysToCompare.every((keyToCompare) => {\n    const leftValue = leftFileStat[keyToCompare]\n    const rightValue = rightFileStat[keyToCompare]\n    return leftValue === rightValue\n  })\n}\nconst fileStatKeysToCompare = [\n  // mtime the the most likely to change, check it first\n  \"mtimeMs\",\n  \"size\",\n  \"ctimeMs\",\n  \"ino\",\n  \"mode\",\n  \"uid\",\n  \"gid\",\n  \"blksize\",\n]\n\nconst getMtimeResponse = async ({ sourceStat, headers }) => {\n  if (\"if-modified-since\" in headers) {\n    let cachedModificationDate\n    try {\n      cachedModificationDate = new Date(headers[\"if-modified-since\"])\n    } catch (e) {\n      return {\n        status: 400,\n        statusText: \"if-modified-since header is not a valid date\",\n      }\n    }\n\n    const actualModificationDate = dateToSecondsPrecision(sourceStat.mtime)\n    if (Number(cachedModificationDate) >= Number(actualModificationDate)) {\n      return {\n        status: 304,\n      }\n    }\n  }\n\n  return {\n    status: 200,\n    headers: {\n      \"last-modified\": dateToUTCString(sourceStat.mtime),\n    },\n  }\n}\n\nconst getRawResponse = async ({\n  cancellationToken,\n  sourceStat,\n  sourceUrl,\n  canReadDirectory,\n  contentTypeMap,\n}) => {\n  if (sourceStat.isDirectory()) {\n    if (canReadDirectory === false) {\n      return {\n        status: 403,\n        statusText: \"not allowed to read directory\",\n      }\n    }\n\n    const [readDirectoryTiming, directoryContentArray] = await timeFunction(\n      \"file service>read directory\",\n      () =>\n        createOperation({\n          cancellationToken,\n          start: () => readDirectory(sourceUrl),\n        }),\n    )\n    const directoryContentJson = JSON.stringify(directoryContentArray)\n\n    return {\n      status: 200,\n      headers: {\n        \"content-type\": \"application/json\",\n        \"content-length\": directoryContentJson.length,\n      },\n      body: directoryContentJson,\n      timing: readDirectoryTiming,\n    }\n  }\n\n  // not a file, give up\n  if (!sourceStat.isFile()) {\n    return {\n      status: 404,\n    }\n  }\n\n  return {\n    status: 200,\n    headers: {\n      \"content-type\": urlToContentType(sourceUrl, contentTypeMap),\n      \"content-length\": sourceStat.size,\n    },\n    body: createReadStream(urlToFileSystemPath(sourceUrl), { emitClose: true }),\n  }\n}\n\nconst onceReadableStreamUsedOrClosed = (readableStream, callback) => {\n  const dataOrCloseCallback = () => {\n    readableStream.removeListener(\"data\", dataOrCloseCallback)\n    readableStream.removeListener(\"close\", dataOrCloseCallback)\n    callback()\n  }\n  readableStream.on(\"data\", dataOrCloseCallback)\n  readableStream.on(\"close\", dataOrCloseCallback)\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toUTCString\nconst dateToUTCString = (date) => date.toUTCString()\n\nconst dateToSecondsPrecision = (date) => {\n  const dateWithSecondsPrecision = new Date(date)\n  dateWithSecondsPrecision.setMilliseconds(0)\n  return dateWithSecondsPrecision\n}\n",
    "// https://github.com/node-fetch/node-fetch/blob/8c197f8982a238b3c345c64b17bfa92e16b4f7c4/src/response.js#L1\n\nimport { createRequire } from \"module\"\nimport { Agent } from \"https\"\nimport { createCancellationToken } from \"@jsenv/cancellation\"\nimport { serveFile } from \"./serveFile.js\"\n\nconst require = createRequire(import.meta.url)\nconst nodeFetch = require(\"node-fetch\")\nconst AbortController = require(\"abort-controller\")\n\nconst { Response } = nodeFetch\n\nexport const fetchUrl = async (\n  url,\n  {\n    cancellationToken = createCancellationToken(),\n    simplified = false,\n    ignoreHttpsError = false,\n    canReadDirectory,\n    contentTypeMap,\n    cacheStrategy,\n    ...options\n  } = {},\n) => {\n  try {\n    url = String(new URL(url))\n  } catch (e) {\n    throw new Error(`fetchUrl first argument must be an absolute url, received ${url}`)\n  }\n\n  if (url.startsWith(\"file://\")) {\n    const { status, statusText, headers, body } = await serveFile(url, {\n      cancellationToken,\n      cacheStrategy,\n      canReadDirectory,\n      contentTypeMap,\n      ...options,\n    })\n    const response = new Response(typeof body === \"string\" ? Buffer.from(body) : body, {\n      url,\n      status,\n      statusText,\n      headers,\n    })\n    return simplified ? standardResponseToSimplifiedResponse(response) : response\n  }\n\n  // cancellation might be requested early, abortController does not support that\n  // so we have to throw if requested right away\n  cancellationToken.throwIfRequested()\n\n  // https://github.com/bitinn/node-fetch#request-cancellation-with-abortsignal\n  const abortController = new AbortController()\n\n  let cancelError\n  cancellationToken.register((reason) => {\n    cancelError = reason\n    abortController.abort(reason)\n  })\n\n  let response\n  try {\n    response = await nodeFetch(url, {\n      signal: abortController.signal,\n      ...(ignoreHttpsError && url.startsWith(\"https\")\n        ? {\n            agent: new Agent({\n              rejectUnauthorized: false,\n            }),\n          }\n        : {}),\n      ...options,\n    })\n  } catch (e) {\n    if (e.message.includes(\"reason: connect ECONNRESET\")) {\n      if (cancelError) {\n        throw cancelError\n      }\n      throw e\n    }\n    if (e.name === \"AbortError\") {\n      if (cancelError) {\n        throw cancelError\n      }\n      throw e\n    }\n    throw e\n  }\n\n  return simplified ? standardResponseToSimplifiedResponse(response) : response\n}\n\nconst standardResponseToSimplifiedResponse = async (response) => {\n  const text = await response.text()\n  return {\n    url: response.url,\n    status: response.status,\n    statusText: response.statusText,\n    headers: responseToHeaders(response),\n    body: text,\n  }\n}\n\nconst responseToHeaders = (response) => {\n  const headers = {}\n  response.headers.forEach((value, name) => {\n    headers[name] = value\n  })\n  return headers\n}\n",
    "import { createStoppableOperation } from \"@jsenv/cancellation\"\n\nexport const listen = ({ cancellationToken, server, port, ip }) => {\n  return createStoppableOperation({\n    cancellationToken,\n    start: () => startListening(server, port, ip),\n    stop: () => stopListening(server),\n  })\n}\n\nexport const startListening = (server, port, ip) =>\n  new Promise((resolve, reject) => {\n    server.on(\"error\", reject)\n    server.on(\"listening\", () => {\n      // in case port is 0 (randomly assign an available port)\n      // https://nodejs.org/api/net.html#net_server_listen_port_host_backlog_callback\n      resolve(server.address().port)\n    })\n    server.listen(port, ip)\n  })\n\nexport const stopListening = (server) =>\n  new Promise((resolve, reject) => {\n    server.on(\"error\", reject)\n    server.on(\"close\", resolve)\n    server.close()\n  })\n",
    "import { createServer } from \"net\"\nimport { createCancellationToken } from \"@jsenv/cancellation\"\nimport { listen } from \"./internal/listen.js\"\n\nexport const findFreePort = async (\n  initialPort = 1,\n  {\n    cancellationToken = createCancellationToken(),\n    ip = \"127.0.0.1\",\n    min = 1,\n    max = 65534,\n    next = (port) => port + 1,\n  } = {},\n) => {\n  const testUntil = async (port, ip) => {\n    const free = await portIsFree({ cancellationToken, port, ip })\n    if (free) {\n      return port\n    }\n    const nextPort = next(port)\n\n    if (nextPort > max) {\n      throw new Error(`${ip} has no available port between ${min} and ${max}`)\n    }\n\n    return testUntil(nextPort, ip)\n  }\n\n  return testUntil(initialPort, ip)\n}\n\nconst portIsFree = async ({ cancellationToken, port, ip }) => {\n  const server = createServer()\n\n  const listenOperation = listen({\n    cancellationToken,\n    server,\n    port,\n    ip,\n  })\n\n  try {\n    await listenOperation\n  } catch (error) {\n    if (error && error.code === \"EADDRINUSE\") {\n      return false\n    }\n    if (error && error.code === \"EACCES\") {\n      return false\n    }\n    return Promise.reject(error)\n  }\n\n  const stopPromise = listenOperation.stop()\n  // cancellation must wait for server to be closed before considering\n  // cancellation as done\n  cancellationToken.register(() => stopPromise)\n  await stopPromise\n  return true\n}\n",
    "import { firstOperationMatching } from \"@jsenv/cancellation\"\nimport { timeFunction } from \"./serverTiming.js\"\nimport { composeResponse } from \"./composeResponse.js\"\n\nexport const firstService = (...callbacks) => {\n  return (request) => {\n    return firstOperationMatching({\n      array: callbacks,\n      start: (callback) => callback(request),\n      predicate: serviceGeneratedResponsePredicate,\n    })\n  }\n}\n\nexport const firstServiceWithTiming = (namedServices) => {\n  return async (request) => {\n    const servicesTiming = {}\n    const response = await firstOperationMatching({\n      array: Object.keys(namedServices).map((serviceName) => {\n        return { serviceName, serviceFn: namedServices[serviceName] }\n      }),\n      start: async ({ serviceName, serviceFn }) => {\n        const [serviceTiming, value] = await timeFunction(serviceName, () => serviceFn(request))\n        Object.assign(servicesTiming, serviceTiming)\n        return value\n      },\n      predicate: (value) => {\n        if (value === null) {\n          return false\n        }\n        return typeof value === \"object\"\n      },\n    })\n    if (response) {\n      return composeResponse({ timing: servicesTiming }, response)\n    }\n    return null\n  }\n}\n\nconst serviceGeneratedResponsePredicate = (value) => {\n  if (value === null) {\n    return false\n  }\n  return typeof value === \"object\"\n}\n",
    "export const jsenvAccessControlAllowedHeaders = [\"x-requested-with\"]\n",
    "export const jsenvAccessControlAllowedMethods = [\"GET\", \"POST\", \"PUT\", \"DELETE\", \"OPTIONS\"]\n",
    "export const jsenvRootCertificate = `-----BEGIN CERTIFICATE-----\nMIIDrzCCApegAwIBAgIBAjANBgkqhkiG9w0BAQsFADCBkTEuMCwGA1UEAxMlaHR0\ncHM6Ly9naXRodWIuY29tL2pzZW52L2pzZW52LXNlcnZlcjELMAkGA1UEBhMCRlIx\nGDAWBgNVBAgTD0FscGVzIE1hcml0aW1lczERMA8GA1UEBxMIVmFsYm9ubmUxDjAM\nBgNVBAoTBWpzZW52MRUwEwYDVQQLEwxqc2VudiBzZXJ2ZXIwHhcNMjAwNTAzMTg0\nNzU0WhcNMjkwNTAzMTg0NzU1WjCBkTEuMCwGA1UEAxMlaHR0cHM6Ly9naXRodWIu\nY29tL2pzZW52L2pzZW52LXNlcnZlcjELMAkGA1UEBhMCRlIxGDAWBgNVBAgTD0Fs\ncGVzIE1hcml0aW1lczERMA8GA1UEBxMIVmFsYm9ubmUxDjAMBgNVBAoTBWpzZW52\nMRUwEwYDVQQLEwxqc2VudiBzZXJ2ZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw\nggEKAoIBAQC4E/QxOsJZlbM+o7V0fRLvV1ZL7zKXMxFHd05V33Z9Lg3/thvbq5sv\nfHZ1kOCnhR9CI4tpypbGXcugP/KevBzsXzJkEdGofdtT9V9OcyeC28hcnh+kswI5\nWa8rJ6InEtJSlA2aduJkMaW3GK24w+9sypFazbXdurHShaJoi1FV6vePy+Ddc2MM\n0gqE0pxT1oh1gZwHs5MR5KABZrsZX+NQRk2ARl4DZFeAYOioSWE0/dNLQP38MCro\nz5CcZ5eRKOJ+W41oNxK4OMbk5tOYc+4La9qA8KKE7HCMWxXY2QRYlryNJVf134vk\n2Ow6ajiEZMClQk7Oh8H07tu0qwbXM/G1AgMBAAGjEDAOMAwGA1UdEwQFMAMBAf8w\nDQYJKoZIhvcNAQELBQADggEBABQaaP2GOzi/5dYeL33pIyomz9Z5ActCxjdkPsYo\nt5fg8qSsR1Yb3iabwah1vIXHxYWIQhVSaHD9y4qwad4Dni1Iq2YMNZ6i/JT/sxcu\nQEobVxIvuyZN2qSNteQNoNzdO7xDjAU6WTPG4w1DI71Wk1P9atduiJ83nh0A3YBq\nGNQkev5HhSvf52OKsOoL9wAN7iPEfB/487fD2pVKsLl5czEgYMTgNuo9fEgPtg+F\nWM9jzCbw1H31bETxLEXRlbT7nmLGp4zHAwdVp5TAuqjWzNCuu1vAG7AyPvJYoLrG\nfuXJx+wW/G0P0KSTuWNqG88dpBag7wQnvshoZ8MELcEvqxw=\n-----END CERTIFICATE-----`\n\nexport const jsenvPrivateKey = `-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEA7g8u1+cEfCDTX2aMPkCjehz29cJpSqL8DZD7SPvznmXMXY8U\n/TcIcqN3NtPlAyNIjE/5NiQkPJKtgx06E5J1eGFQn8yt54E+2eQNNjz0elxkHmmN\nHwqbD76r6JuIoh/vfNhyw+2jaOO8R+sAJGywu2jFaDtxhho+1xaK1m92zdhu5U3K\nQMg97xuYx+/ezb4JllFBtcs3/uE2Hg50pWO6eny1EtEDfnMhE5L42DyMtoHU+Exd\nF3bGo9FxCq04UFU+ZRCuLUIY/AI8PsMcgcwq7n+O0ijylFoatmyudx+VMoHENWAL\nlBdfjALE3K3XPX6s2IzAVAa4CDpmC2aQ3UCElQIDAQABAoIBAQDh4TYpVeJDhUIK\ne1sGln6HF4Scm+McFpnipXZJQgdefGj1PRZFTTqOy9wKAfSCjbAAssFcRd68OtC4\nX7sDZyxfFLdTaPp5d4ETbfe7RwsSLygwUya8FWwb/GdRRoLWkkbCxv3eOlWa6Lt1\n4d04sojeygLFa+HDxJNrss/5t7mahbX02xTxM5O6Ly+gQDheIepjDNFmXPCvoVHq\nDk3tNeEPsP6qECBWfbfz6eGGBvWsp/copc7ndL+svDmXyJsbZxaOJg0nJ6k4sMOW\nlTueGsr9t/H2wghhquNDK/Vy4e2YQhZ6VG6L0Yy2UtUfIO3JQbSYHIZpSMj1Mdkh\nt675JTfhAoGBAPjTzrkCkIj9g3GITNk556ZQ9W3O8NzbmBtyxdcAQTFhL69K81wy\nMrMvZ2YHPs+WwO6KrGLabDb2qf5xohp8Rgl09f3TjF+1L+ouVjYtKqIaiatA0q3R\n9jpSicyGPSmoo+i2VcHgar3IFcVxGdJoZR+LWR0o7Q1u/WN8HqkkWyp/AoGBAPTr\n6e61xIwlpt4adFFutfpjEaQRWGZ7PtJ+4xQpcztzAYseuBkofierDeCKzkPPsw1J\n1muLYJ9puJjRe/AykoqlF+iloxTM21wlEmtnvVOi+YvFBxj5YJiAiuEGB+42tVH5\n+QbPkcm/lI3reJBuzqrvZkv3fsQhk18Gb0JSWn7rAoGAMS3jyMtJ99lrVlAjKDf6\nofOUXoytLGm2iY5IrfLd772OqC2/JbTCMoom/JJoBq18GmmMIsma484i0Shyapuv\nWAUm7XEXaH8uJjHcVj7dE0b9eLyKJ1K9QM+5bpQFmKs9IiyPjI8nabUXIHv3J4/8\nlJx9E3dYSvRp3nTUtod6AU8CgYEAlz/5P0lRD5tQ6Wg83O0ZxH7ZrhBoHyGNMkDZ\nyuGuH9Bt65QU7LRs8+JWt4wAxS/GyzYGDHQOP2Pyc60qdLNGfAhoM2vWwkmgTc83\nCM0Pxk6m/QG32FxoosT+/ufSjfGLGAzfFK2qwoRlIR+BXPCRAE7HRbKZvlVdxRkc\nLEDfUfECgYANyg47HujS+lZb+3zm2/D/nP25BuGxADL07i4yHIxGSqEYS6MJAOq8\n0fJCOcOeK4XypFGvrVyZiVkWd3qTE1BuIFFRpqER7HYvThPBkJ/gOwjuqZQv5syL\n3+3M4qUvCSqYxAr3Bj2xpPO6ysXdPdJMqU/b/gWuS/VblvXHrMExdA==\n-----END RSA PRIVATE KEY-----`\n\nexport const jsenvPublicKey = `-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7g8u1+cEfCDTX2aMPkCj\nehz29cJpSqL8DZD7SPvznmXMXY8U/TcIcqN3NtPlAyNIjE/5NiQkPJKtgx06E5J1\neGFQn8yt54E+2eQNNjz0elxkHmmNHwqbD76r6JuIoh/vfNhyw+2jaOO8R+sAJGyw\nu2jFaDtxhho+1xaK1m92zdhu5U3KQMg97xuYx+/ezb4JllFBtcs3/uE2Hg50pWO6\neny1EtEDfnMhE5L42DyMtoHU+ExdF3bGo9FxCq04UFU+ZRCuLUIY/AI8PsMcgcwq\n7n+O0ijylFoatmyudx+VMoHENWALlBdfjALE3K3XPX6s2IzAVAa4CDpmC2aQ3UCE\nlQIDAQAB\n-----END PUBLIC KEY-----`\n\nexport const jsenvCertificate = `-----BEGIN CERTIFICATE-----\nMIIECjCCAvKgAwIBAgIBATANBgkqhkiG9w0BAQsFADCBkTEuMCwGA1UEAxMlaHR0\ncHM6Ly9naXRodWIuY29tL2pzZW52L2pzZW52LXNlcnZlcjELMAkGA1UEBhMCRlIx\nGDAWBgNVBAgTD0FscGVzIE1hcml0aW1lczERMA8GA1UEBxMIVmFsYm9ubmUxDjAM\nBgNVBAoTBWpzZW52MRUwEwYDVQQLEwxqc2VudiBzZXJ2ZXIwHhcNMjAwNTAzMTg0\nNzU0WhcNMjkwNTAzMTg0NzU1WjCBkTEuMCwGA1UEAxMlaHR0cHM6Ly9naXRodWIu\nY29tL2pzZW52L2pzZW52LXNlcnZlcjELMAkGA1UEBhMCRlIxGDAWBgNVBAgTD0Fs\ncGVzIE1hcml0aW1lczERMA8GA1UEBxMIVmFsYm9ubmUxDjAMBgNVBAoTBWpzZW52\nMRUwEwYDVQQLEwxqc2VudiBzZXJ2ZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw\nggEKAoIBAQDuDy7X5wR8INNfZow+QKN6HPb1wmlKovwNkPtI+/OeZcxdjxT9Nwhy\no3c20+UDI0iMT/k2JCQ8kq2DHToTknV4YVCfzK3ngT7Z5A02PPR6XGQeaY0fCpsP\nvqvom4iiH+982HLD7aNo47xH6wAkbLC7aMVoO3GGGj7XForWb3bN2G7lTcpAyD3v\nG5jH797NvgmWUUG1yzf+4TYeDnSlY7p6fLUS0QN+cyETkvjYPIy2gdT4TF0Xdsaj\n0XEKrThQVT5lEK4tQhj8Ajw+wxyBzCruf47SKPKUWhq2bK53H5UygcQ1YAuUF1+M\nAsTcrdc9fqzYjMBUBrgIOmYLZpDdQISVAgMBAAGjazBpMB8GA1UdIwQYMBaAFFJJ\nBlTW2Lp6maSe/c6HfH+zee1xMA4GA1UdDwEB/wQEAwIFoDATBgNVHSUEDDAKBggr\nBgEFBQcDATAhBgNVHREEGjAYhwR/AAABgglsb2NhbGhvc3SCBWpzZW52MA0GCSqG\nSIb3DQEBCwUAA4IBAQCJdOdqU0XBoto/ddAbTRC+qzmIl43w6zsUBO/5zEGDIs6x\nMwOOqMzuKtZ4Qm2hYTFfITRrinU2L3XmGdRdGzHF8V6VpOR1D+BZy0IvJBBW7DTE\nzuaBqQ5qtY1x1qtZdWaWZwexQjGlBdXa+yCWCOHs8amlH8WS6jOfvrD/ECpVbvJQ\nXi+4yFFBeJ4P09Wx4YetDSJWFBL1Y5Q3TnqpyxNYZ3A3r/UolbG/HY0NnOGUA6wg\nMHOw0+Zg5Ls7pHo2bN7n1LseYeIt6M90q8/vRS6VjzWImJswxsdqSCP8TZxVb5S5\np2OCbNpxQVtgLpUgLd9ePT2eX2kRTI8knM+C+e7L\n-----END CERTIFICATE-----`\n",
    "export const urlToSearchParamValue = (url, searchParamName) => {\n  return new URL(url).searchParams.get(searchParamName)\n}\n",
    "export const readRequestBodyAsString = (body) => {\n  return new Promise((resolve, reject) => {\n    const bufferArray = []\n    body.subscribe({\n      error: reject,\n      next: (buffer) => {\n        bufferArray.push(buffer)\n      },\n      complete: () => {\n        const bodyAsBuffer = Buffer.concat(bufferArray)\n        const bodyAsString = bodyAsBuffer.toString()\n        resolve(bodyAsString)\n      },\n    })\n  })\n}\n",
    "export const createTracker = () => {\n  const callbackArray = []\n\n  const registerCleanupCallback = (callback) => {\n    if (typeof callback !== \"function\")\n      throw new TypeError(`callback must be a function\ncallback: ${callback}`)\n    callbackArray.push(callback)\n  }\n\n  const cleanup = async (reason) => {\n    const localCallbackArray = callbackArray.slice()\n    await Promise.all(localCallbackArray.map((callback) => callback(reason)))\n  }\n\n  return { registerCleanupCallback, cleanup }\n}\n",
    "export const urlToOrigin = (url) => {\n  return new URL(url).origin\n}\n",
    "export const createServer = async ({ http2, http1Allowed, protocol, privateKey, certificate }) => {\n  if (protocol === \"http\") {\n    if (http2) {\n      const { createServer } = await import(\"http2\")\n      return createServer()\n    }\n\n    const { createServer } = await import(\"http\")\n    return createServer()\n  }\n\n  if (protocol === \"https\") {\n    if (http2) {\n      const { createSecureServer } = await import(\"http2\")\n      return createSecureServer({\n        key: privateKey,\n        cert: certificate,\n        allowHTTP1: http1Allowed,\n      })\n    }\n\n    const { createServer } = await import(\"https\")\n    return createServer({\n      key: privateKey,\n      cert: certificate,\n    })\n  }\n\n  throw new Error(`unsupported protocol ${protocol}`)\n}\n",
    "export const trackServerPendingConnections = (nodeServer, { http2, onConnectionError }) => {\n  if (http2) {\n    // see http2.js: we rely on https://nodejs.org/api/http2.html#http2_compatibility_api\n    return trackHttp1ServerPendingConnections(nodeServer, { onConnectionError })\n  }\n  return trackHttp1ServerPendingConnections(nodeServer, { onConnectionError })\n}\n\n// const trackHttp2ServerPendingSessions = () => {}\n\nconst trackHttp1ServerPendingConnections = (nodeServer, { onConnectionError }) => {\n  const pendingConnections = new Set()\n\n  const connectionListener = (connection) => {\n    connection.on(\"close\", () => {\n      pendingConnections.delete(connection)\n    })\n    if (onConnectionError) {\n      connection.on(\"error\", (error) => {\n        onConnectionError(error, connection)\n      })\n    }\n    pendingConnections.add(connection)\n  }\n\n  nodeServer.on(\"connection\", connectionListener)\n\n  const stop = async (reason) => {\n    nodeServer.removeListener(\"connection\", connectionListener)\n\n    await Promise.all(\n      Array.from(pendingConnections).map((pendingConnection) => {\n        return new Promise((resolve, reject) => {\n          pendingConnection.destroy(reason, (error) => {\n            if (error) {\n              if (error === reason || error.code === \"ENOTCONN\") {\n                resolve()\n              } else {\n                reject(error)\n              }\n            } else {\n              resolve()\n            }\n          })\n        })\n      }),\n    )\n  }\n\n  return { stop }\n}\n",
    "export const trackServerPendingRequests = (nodeServer, { http2 }) => {\n  if (http2) {\n    // see http2.js: we rely on https://nodejs.org/api/http2.html#http2_compatibility_api\n    return trackHttp1ServerPendingRequests(nodeServer)\n  }\n  return trackHttp1ServerPendingRequests(nodeServer)\n}\n\n// const trackHttp2ServerPendingStreams = () => {}\n\nconst trackHttp1ServerPendingRequests = (nodeServer) => {\n  const pendingClients = new Set()\n\n  const requestListener = (nodeRequest, nodeResponse) => {\n    const client = { nodeRequest, nodeResponse }\n\n    pendingClients.add(client)\n    nodeResponse.on(\"close\", () => {\n      pendingClients.delete(client)\n    })\n  }\n\n  nodeServer.on(\"request\", requestListener)\n\n  const stop = ({ status, reason }) => {\n    nodeServer.removeListener(\"request\", requestListener)\n\n    return Promise.all(\n      Array.from(pendingClients).map(({ nodeResponse }) => {\n        if (nodeResponse.headersSent === false) {\n          nodeResponse.writeHead(status, reason)\n        }\n\n        // http2\n        if (nodeResponse.close) {\n          return new Promise((resolve, reject) => {\n            if (nodeResponse.closed) {\n              resolve()\n            } else {\n              nodeResponse.close((error) => {\n                if (error) {\n                  reject(error)\n                } else {\n                  resolve()\n                }\n              })\n            }\n          })\n        }\n\n        // http\n        return new Promise((resolve) => {\n          if (nodeResponse.destroyed) {\n            resolve()\n          } else {\n            nodeResponse.once(\"close\", () => {\n              resolve()\n            })\n            nodeResponse.destroy()\n          }\n        })\n      }),\n    )\n  }\n\n  return { stop }\n}\n",
    "import { createObservable } from \"./observable.js\"\n\nexport const nodeStreamToObservable = (nodeStream) => {\n  return createObservable({\n    subscribe: ({ next, error, complete }) => {\n      // should we do nodeStream.resume() in case the stream was paused ?\n      nodeStream.on(\"data\", next)\n      nodeStream.once(\"error\", error)\n      nodeStream.once(\"end\", complete)\n\n      const unsubscribe = () => {\n        nodeStream.removeListener(\"data\", next)\n        nodeStream.removeListener(\"error\", error)\n        nodeStream.removeListener(\"end\", complete)\n\n        if (typeof nodeStream.abort === \"function\") {\n          nodeStream.abort()\n        } else {\n          nodeStream.destroy()\n        }\n      }\n\n      if (typeof nodeStream.once === \"function\") {\n        nodeStream.once(\"abort\", unsubscribe)\n      }\n\n      return {\n        unsubscribe,\n      }\n    },\n  })\n}\n",
    "export const normalizeHeaderName = (headerName) => {\n  headerName = String(headerName)\n  if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(headerName)) {\n    throw new TypeError(\"Invalid character in header field name\")\n  }\n\n  return headerName.toLowerCase()\n}\n",
    "export const normalizeHeaderValue = (headerValue) => {\n  return String(headerValue)\n}\n",
    "/*\nhttps://developer.mozilla.org/en-US/docs/Web/API/Headers\nhttps://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\n*/\n\nimport { normalizeHeaderName } from \"./normalizeHeaderName.js\"\nimport { normalizeHeaderValue } from \"./normalizeHeaderValue.js\"\n\nexport const headersFromObject = (headersObject) => {\n  const headers = {}\n\n  Object.keys(headersObject).forEach((headerName) => {\n    if (headerName[0] === \":\") {\n      // exclude http2 headers\n      return\n    }\n    headers[normalizeHeaderName(headerName)] = normalizeHeaderValue(headersObject[headerName])\n  })\n\n  return headers\n}\n",
    "import { composeCancellationToken, createCancellationSource } from \"@jsenv/cancellation\"\nimport { nodeStreamToObservable } from \"./nodeStreamToObservable.js\"\nimport { headersFromObject } from \"./headersFromObject.js\"\n\nexport const nodeRequestToRequest = (nodeRequest, { serverCancellationToken, serverOrigin }) => {\n  const { method } = nodeRequest\n  const { url: ressource } = nodeRequest\n  const headers = headersFromObject(nodeRequest.headers)\n  const body =\n    method === \"POST\" || method === \"PUT\" || method === \"PATCH\"\n      ? nodeStreamToObservable(nodeRequest)\n      : undefined\n\n  let requestOrigin\n  if (nodeRequest.authority) {\n    requestOrigin = nodeRequest.connection.encrypted\n      ? `https://${nodeRequest.authority}`\n      : `http://${nodeRequest.authority}`\n  } else if (nodeRequest.headers.host) {\n    requestOrigin = nodeRequest.connection.encrypted\n      ? `https://${nodeRequest.headers.host}`\n      : `http://${nodeRequest.headers.host}`\n  } else {\n    requestOrigin = serverOrigin\n  }\n\n  return Object.freeze({\n    // the node request is considered as cancelled if client cancels or server cancels.\n    // in case of server cancellation from a client perspective request is not cancelled\n    // because client still wants a response. But from a server perspective the production\n    // of a response for this request is cancelled\n    cancellationToken: composeCancellationToken(\n      serverCancellationToken,\n      nodeRequestToCancellationToken(nodeRequest),\n    ),\n    origin: requestOrigin,\n    ressource,\n    method,\n    headers,\n    body,\n  })\n}\n\nconst nodeRequestToCancellationToken = (nodeRequest) => {\n  const { cancel, token } = createCancellationSource()\n  nodeRequest.on(\"abort\", () => {\n    cancel(\"request aborted\")\n  })\n  nodeRequest.on(\"close\", () => {\n    cancel(\"request closed\")\n  })\n  return token\n}\n",
    "import { createObservable } from \"./observable.js\"\n\nexport const valueToObservable = (value) => {\n  return createObservable({\n    subscribe: ({ next, complete }) => {\n      next(value)\n      complete()\n      return {\n        unsubscribe: () => {},\n      }\n    },\n  })\n}\n",
    "import { Stream, Writable, Readable } from \"stream\"\nimport { isObservable, subscribe } from \"./observable.js\"\nimport { nodeStreamToObservable } from \"./nodeStreamToObservable.js\"\nimport { valueToObservable } from \"./valueToObservable.js\"\n\nexport const populateNodeResponse = (\n  nodeResponse,\n  { status, statusText, headers, body, bodyEncoding },\n  { cancellationToken, ignoreBody, ignoreStatusText, ignoreConnectionHeader } = {},\n) => {\n  const nodeHeaders = headersToNodeHeaders(headers, { ignoreConnectionHeader })\n  // nodejs strange signature for writeHead force this\n  // https://nodejs.org/api/http.html#http_response_writehead_statuscode_statusmessage_headers\n  if (statusText === undefined || ignoreStatusText) {\n    nodeResponse.writeHead(status, nodeHeaders)\n  } else {\n    nodeResponse.writeHead(status, statusText, nodeHeaders)\n  }\n  if (ignoreBody) {\n    nodeResponse.end()\n    return\n  }\n\n  if (bodyEncoding) {\n    nodeResponse.setEncoding(bodyEncoding)\n  }\n\n  const observable = bodyToObservable(body)\n  const subscription = subscribe(observable, {\n    next: (data) => {\n      try {\n        nodeResponse.write(data)\n      } catch (e) {\n        // Something inside Node.js sometimes puts stream\n        // in a state where .write() throw despites nodeResponse.destroyed\n        // being undefined and \"close\" event not being emitted.\n        // I have tested if we are the one calling destroy\n        // (I have commented every .destroy() call)\n        // but issue still occurs\n        // For the record it's \"hard\" to reproduce but can be by running\n        // a lot of tests against a browser in the context of @jsenv/core testing\n        if (e.code === \"ERR_HTTP2_INVALID_STREAM\") {\n          return\n        }\n        throw e\n      }\n    },\n    error: (value) => {\n      nodeResponse.emit(\"error\", value)\n    },\n    complete: () => {\n      nodeResponse.end()\n    },\n  })\n\n  cancellationToken.register(() => {\n    subscription.unsubscribe()\n    nodeResponse.destroy()\n  })\n  nodeResponse.once(\"close\", () => {\n    // close body in case nodeResponse is prematurely closed\n    // while body is writing\n    // it may happen in case of server sent event\n    // where body is kept open to write to client\n    // and the browser is reloaded or closed for instance\n    subscription.unsubscribe()\n  })\n}\n\nconst mapping = {\n  // \"content-type\": \"Content-Type\",\n  // \"last-modified\": \"Last-Modified\",\n}\n\nconst headersToNodeHeaders = (headers, { ignoreConnectionHeader }) => {\n  const nodeHeaders = {}\n\n  Object.keys(headers).forEach((name) => {\n    if (name === \"connection\" && ignoreConnectionHeader) return\n    const nodeHeaderName = name in mapping ? mapping[name] : name\n    nodeHeaders[nodeHeaderName] = headers[name]\n  })\n\n  return nodeHeaders\n}\n\nconst bodyToObservable = (body) => {\n  if (isObservable(body)) return body\n  if (isNodeStream(body)) return nodeStreamToObservable(body)\n  return valueToObservable(body)\n}\n\nconst isNodeStream = (value) => {\n  if (value === undefined) return false\n  if (value instanceof Stream) return true\n  if (value instanceof Writable) return true\n  if (value instanceof Readable) return true\n  return false\n}\n",
    "// https://github.com/Marak/colors.js/blob/b63ef88e521b42920a9e908848de340b31e68c9d/lib/styles.js#L29\n\nconst close = \"\\x1b[0m\"\nconst red = \"\\x1b[31m\"\nconst green = \"\\x1b[32m\"\nconst yellow = \"\\x1b[33m\"\n// const blue = \"\\x1b[34m\"\nconst magenta = \"\\x1b[35m\"\nconst cyan = \"\\x1b[36m\"\n// const white = \"\\x1b[37m\"\n\nexport const colorizeResponseStatus = (status) => {\n  const statusType = statusToType(status)\n\n  if (statusType === \"information\") return `${cyan}${status}${close}`\n  if (statusType === \"success\") return `${green}${status}${close}`\n  if (statusType === \"redirection\") return `${magenta}${status}${close}`\n  if (statusType === \"client-error\") return `${yellow}${status}${close}`\n  if (statusType === \"server-error\") return `${red}${status}${close}`\n  return status\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/HTTP/Status\nconst statusToType = (status) => {\n  if (statusIsInformation(status)) return \"information\"\n  if (statusIsSuccess(status)) return \"success\"\n  if (statusIsRedirection(status)) return \"redirection\"\n  if (statusIsClientError(status)) return \"client-error\"\n  if (statusIsServerError(status)) return \"server-error\"\n  return \"unknown\"\n}\n\nconst statusIsInformation = (status) => status >= 100 && status < 200\n\nconst statusIsSuccess = (status) => status >= 200 && status < 300\n\nconst statusIsRedirection = (status) => status >= 300 && status < 400\n\nconst statusIsClientError = (status) => status >= 400 && status < 500\n\nconst statusIsServerError = (status) => status >= 500 && status < 600\n",
    "import { networkInterfaces } from \"os\"\nimport { URL } from \"url\"\n\nexport const getServerOrigins = ({ protocol, ip, port }) => {\n  return {\n    main: createServerOrigin({ protocol, ip, port }),\n    external: createServerOrigin({ protocol, ip: getExternalIp(ip), port }),\n  }\n}\n\nconst createServerOrigin = ({ protocol, ip, port }) => {\n  const url = new URL(\"https://127.0.0.1:80\")\n\n  url.protocol = protocol\n  url.hostname = ipToHostname(ip)\n  url.port = port\n\n  return url.origin\n}\n\nconst ipToHostname = (\n  ip,\n  { preferLocalhost = true, preferLocalIp = false, preferExternalIp = false } = {},\n) => {\n  if (ip === \"0.0.0.0\" || !ip) {\n    if (preferLocalhost) return \"localhost\"\n    if (preferLocalIp) return \"127.0.0.1\"\n    if (preferExternalIp) return getExternalIp(ip) || \"0.0.0.0\"\n    return \"0.0.0.0\"\n  }\n  return ip\n}\n\nconst getExternalIp = () => {\n  const networkInterfaceMap = networkInterfaces()\n  let internalIPV4NetworkAddress\n\n  Object.keys(networkInterfaceMap).find((key) => {\n    const networkAddressArray = networkInterfaceMap[key]\n    return networkAddressArray.find((networkAddress) => {\n      if (networkAddress.internal) return false\n      if (networkAddress.family !== \"IPv4\") return false\n      internalIPV4NetworkAddress = networkAddress\n      return true\n    })\n  })\n\n  return internalIPV4NetworkAddress ? internalIPV4NetworkAddress.address : null\n}\n",
    "const createReason = (reasonString) => {\n  return {\n    toString: () => reasonString,\n  }\n}\n\nexport const STOP_REASON_INTERNAL_ERROR = createReason(\"Internal error\")\nexport const STOP_REASON_PROCESS_SIGHUP = createReason(\"process SIGHUP\")\nexport const STOP_REASON_PROCESS_SIGTERM = createReason(\"process SIGTERM\")\nexport const STOP_REASON_PROCESS_SIGINT = createReason(\"process SIGINT\")\nexport const STOP_REASON_PROCESS_BEFORE_EXIT = createReason(\"process before exit\")\nexport const STOP_REASON_PROCESS_EXIT = createReason(\"process exit\")\nexport const STOP_REASON_NOT_SPECIFIED = createReason(\"not specified\")\n",
    "export const trackServerRequest = (nodeServer, fn, { http2 }) => {\n  if (http2) {\n    // see http2.js: we rely on https://nodejs.org/api/http2.html#http2_compatibility_api\n    return trackHttp1ServerRequest(nodeServer, fn)\n  }\n  return trackHttp1ServerRequest(nodeServer, fn)\n}\n\n// const trackHttp2ServerRequest = (nodeServer, fn) => {\n//   nodeServer.on(\"stream\", fn)\n//   return () => {\n//     nodeServer.removeListener(\"stream\", fn)\n//   }\n// }\n\nconst trackHttp1ServerRequest = (nodeServer, fn) => {\n  nodeServer.on(\"request\", fn)\n  return () => {\n    nodeServer.removeListener(\"request\", fn)\n  }\n}\n",
    "/* eslint-disable import/max-dependencies */\n\nimport { createRequire } from \"module\"\nimport { STATUS_CODES } from \"http\"\nimport {\n  createCancellationToken,\n  createOperation,\n  createStoppableOperation,\n  composeCancellationToken,\n  createCancellationSource,\n  isCancelError,\n  executeAsyncFunction\n} from \"@jsenv/cancellation\"\nimport { SIGINTSignal, unadvisedCrashSignal, teardownSignal } from \"@jsenv/node-signals\"\nimport { memoize } from \"@jsenv/util\"\nimport { createLogger } from \"@jsenv/logger\"\nimport { createTracker } from \"./internal/createTracker.js\"\nimport { urlToOrigin } from \"./internal/urlToOrigin.js\"\nimport { createServer } from \"./internal/createServer.js\"\nimport { trackServerPendingConnections } from \"./internal/trackServerPendingConnections.js\"\nimport { trackServerPendingRequests } from \"./internal/trackServerPendingRequests.js\"\nimport { nodeRequestToRequest } from \"./internal/nodeRequestToRequest.js\"\nimport { composeResponseHeaders } from \"./internal/composeResponseHeaders.js\"\nimport { populateNodeResponse } from \"./internal/populateNodeResponse.js\"\nimport { colorizeResponseStatus } from \"./internal/colorizeResponseStatus.js\"\nimport { getServerOrigins } from \"./internal/getServerOrigins.js\"\nimport { listen, stopListening } from \"./internal/listen.js\"\nimport { composeResponse } from \"./composeResponse.js\"\nimport {\n  STOP_REASON_INTERNAL_ERROR,\n  STOP_REASON_PROCESS_SIGHUP,\n  STOP_REASON_PROCESS_SIGTERM,\n  STOP_REASON_PROCESS_SIGINT,\n  STOP_REASON_PROCESS_BEFORE_EXIT,\n  STOP_REASON_PROCESS_EXIT,\n  STOP_REASON_NOT_SPECIFIED,\n} from \"./stopReasons.js\"\nimport { jsenvAccessControlAllowedHeaders } from \"./jsenvAccessControlAllowedHeaders.js\"\nimport { jsenvAccessControlAllowedMethods } from \"./jsenvAccessControlAllowedMethods.js\"\nimport { jsenvPrivateKey, jsenvCertificate } from \"./jsenvSignature.js\"\nimport { findFreePort } from \"./findFreePort.js\"\nimport { trackServerRequest } from \"./internal/trackServerRequest.js\"\nimport { timeFunction, timingToServerTimingResponseHeaders } from \"./serverTiming.js\"\n\nconst require = createRequire(import.meta.url)\nconst killPort = require(\"kill-port\")\n\nexport const startServer = async ({\n  cancellationToken = createCancellationToken(),\n  logLevel,\n  serverName = \"server\",\n\n  protocol = \"http\",\n  http2 = false,\n  http1Allowed = true,\n  redirectHttpToHttps = false,\n  ip = \"0.0.0.0\", // will it work on windows ? https://github.com/nodejs/node/issues/14900\n  port = 0, // assign a random available port\n  portHint,\n  forcePort = false,\n  privateKey = jsenvPrivateKey,\n  certificate = jsenvCertificate,\n\n  stopOnSIGINT = true,\n  // auto close the server when the process exits\n  stopOnExit = true,\n  // auto close when requestToResponse throw an error\n  stopOnInternalError = false,\n  // auto close the server when an uncaughtException happens\n  stopOnCrash = false,\n  keepProcessAlive = true,\n  requestToResponse = () => null,\n\n  accessControlAllowedOrigins = [],\n  accessControlAllowedMethods = jsenvAccessControlAllowedMethods,\n  accessControlAllowedHeaders = jsenvAccessControlAllowedHeaders,\n  accessControlAllowRequestOrigin = false,\n  accessControlAllowRequestMethod = false,\n  accessControlAllowRequestHeaders = false,\n  accessControlAllowCredentials = false,\n  // by default OPTIONS request can be cache for a long time, it's not going to change soon ?\n  // we could put a lot here, see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Max-Age\n  accessControlMaxAge = 600,\n\n  // https://www.w3.org/TR/server-timing/\n  sendServerTiming = false,\n  sendInternalErrorStack = false,\n  internalErrorToResponseProperties = (error) => {\n    const body = error\n      ? JSON.stringify({\n          code: error.code || \"UNKNOWN_ERROR\",\n          ...(sendInternalErrorStack ? { stack: error.stack } : {}),\n        })\n      : JSON.stringify({ code: \"VALUE_THROWED\", value: error })\n\n    return {\n      headers: {\n        \"content-type\": \"application/json\",\n        \"content-length\": Buffer.byteLength(body),\n      },\n      body,\n    }\n  },\n\n  requestWaitingMs = 20000,\n  requestWaitingCallback = (request, { logger }) => {\n    logger.warn(\n      `still no response found for request after ${requestWaitingMs} ms\n--- request url ---\n${request.origin}${request.ressource}\n--- request headers ---\n${JSON.stringify(request.headers, null, \"  \")}\n`,\n    )\n  },\n\n  startedCallback = () => {},\n  stoppedCallback = () => {},\n  errorIsCancellation = () => false,\n  nagle = true,\n} = {}) => {\n  return executeAsyncFunction(async () => {\n    if (port === 0 && forcePort) {\n      throw new Error(`no need to pass forcePort when port is 0`)\n    }\n    if (protocol !== \"http\" && protocol !== \"https\") {\n      throw new Error(`protocol must be http or https, got ${protocol}`)\n    }\n    if (protocol === \"https\") {\n      if (!privateKey) {\n        throw new Error(`missing privateKey for https server`)\n      }\n      if (!certificate) {\n        throw new Error(`missing certificate for https server`)\n      }\n      if (privateKey !== jsenvPrivateKey && certificate === jsenvCertificate) {\n        throw new Error(`you passed a privateKey without certificate`)\n      }\n      if (certificate !== jsenvCertificate && privateKey === jsenvPrivateKey) {\n        throw new Error(`you passed a certificate without privateKey`)\n      }\n    }\n    if (http2 && protocol !== \"https\") {\n      throw new Error(`http2 needs \"https\" but protocol is \"${protocol}\"`)\n    }\n\n    const internalCancellationSource = createCancellationSource()\n    const externalCancellationToken = cancellationToken\n    const internalCancellationToken = internalCancellationSource.token\n    const serverCancellationToken = composeCancellationToken(\n      externalCancellationToken,\n      internalCancellationToken,\n    )\n\n    const logger = createLogger({ logLevel })\n    if (redirectHttpToHttps && protocol === \"http\") {\n      logger.warn(`redirectHttpToHttps ignored because protocol is http`)\n      redirectHttpToHttps = false\n    }\n    if (redirectHttpToHttps && http2) {\n      logger.warn(\n        `redirectHttpToHttps ignored because it does not work with http2. see https://github.com/nodejs/node/issues/23331`,\n      )\n      redirectHttpToHttps = false\n    }\n\n    const onError = (error) => {\n      if (errorIsCancellation(error)) {\n        return\n      }\n      throw error\n    }\n    errorIsCancellation = composePredicate(errorIsCancellation, isCancelError)\n\n    const { registerCleanupCallback, cleanup } = createTracker()\n\n    if (stopOnCrash) {\n      const unregister = unadvisedCrashSignal.addCallback((reason) => {\n        internalCancellationSource.cancel(reason.value)\n      })\n      registerCleanupCallback(unregister)\n    }\n\n    if (stopOnExit) {\n      const unregister = teardownSignal.addCallback((tearDownReason) => {\n        if (!stopOnSIGINT && tearDownReason === \"SIGINT\") {\n          return\n        }\n\n        internalCancellationSource.cancel(\n          {\n            SIGHUP: STOP_REASON_PROCESS_SIGHUP,\n            SIGTERM: STOP_REASON_PROCESS_SIGTERM,\n            SIGINT: STOP_REASON_PROCESS_SIGINT,\n            beforeExit: STOP_REASON_PROCESS_BEFORE_EXIT,\n            exit: STOP_REASON_PROCESS_EXIT,\n          }[tearDownReason],\n        )\n      })\n      registerCleanupCallback(unregister)\n    } else if (stopOnSIGINT) {\n      const unregister = SIGINTSignal.addCallback(() => {\n        internalCancellationSource.cancel(STOP_REASON_PROCESS_SIGINT)\n      })\n      registerCleanupCallback(unregister)\n    }\n\n    if (forcePort) {\n      await createOperation({\n        cancellationToken: serverCancellationToken,\n        start: () => killPort(port),\n      })\n    }\n\n    const nodeServer = await createServer({\n      http2,\n      http1Allowed,\n      protocol,\n      privateKey,\n      certificate,\n    })\n\n    // https://nodejs.org/api/net.html#net_server_unref\n    if (!keepProcessAlive) {\n      nodeServer.unref()\n    }\n\n    let status = \"starting\"\n\n    let stoppedResolve\n    const stoppedPromise = new Promise((resolve) => {\n      stoppedResolve = resolve\n    })\n    const stop = memoize(async (reason = STOP_REASON_NOT_SPECIFIED) => {\n      status = \"stopping\"\n\n      errorIsCancellation = composePredicate(errorIsCancellation, (error) => error === reason)\n      errorIsCancellation = composePredicate(\n        errorIsCancellation,\n        (error) => error && error.code === \"ECONNRESET\",\n      )\n      logger.info(`${serverName} stopped because ${reason}`)\n\n      await cleanup(reason)\n      await stopListening(nodeServer)\n      status = \"stopped\"\n      stoppedCallback({ reason })\n      stoppedResolve(reason)\n    })\n    serverCancellationToken.register(stop)\n    const startOperation = createStoppableOperation({\n      cancellationToken: serverCancellationToken,\n      start: async () => {\n        if (portHint) {\n          port = await findFreePort(portHint, { cancellationToken: serverCancellationToken, ip })\n        }\n        return listen({\n          cancellationToken: serverCancellationToken,\n          server: nodeServer,\n          port,\n          ip,\n        })\n      },\n      stop: (_, reason) => stop(reason),\n    })\n\n    port = await startOperation\n    status = \"opened\"\n    const serverOrigins = getServerOrigins({ protocol, ip, port })\n    const serverOrigin = serverOrigins.main\n\n    const connectionsTracker = trackServerPendingConnections(nodeServer, {\n      http2,\n      onConnectionError: (error, connection) => {\n        if (!connection.destroyed) {\n          onError(error)\n        }\n      },\n    })\n    // opened connection must be shutdown before the close event is emitted\n    registerCleanupCallback(connectionsTracker.stop)\n\n    const pendingRequestsTracker = trackServerPendingRequests(nodeServer, { http2 })\n    // ensure pending requests got a response from the server\n    registerCleanupCallback((reason) => {\n      pendingRequestsTracker.stop({\n        status: reason === STOP_REASON_INTERNAL_ERROR ? 500 : 503,\n        reason,\n      })\n    })\n\n    const requestCallback = async (nodeRequest, nodeResponse) => {\n      if (!nagle) {\n        nodeRequest.connection.setNoDelay(true)\n      }\n      if (redirectHttpToHttps && !nodeRequest.connection.encrypted) {\n        nodeResponse.writeHead(301, {\n          location: `${serverOrigin}${nodeRequest.ressource}`,\n        })\n        return\n      }\n\n      const request = nodeRequestToRequest(nodeRequest, { serverCancellationToken, serverOrigin })\n      nodeRequest.on(\"error\", (error) => {\n        logger.error(`error on request.\n--- request ressource ---\n${request.ressource}\n--- error stack ---\n${error.stack}`)\n      })\n\n      const [\n        startRespondingTiming,\n        { response, error },\n      ] = await timeFunction(\"time to start responding\", () => generateResponseDescription(request))\n      if (sendServerTiming) {\n        const serverTiming = {\n          ...response.timing,\n          ...startRespondingTiming,\n        }\n        response.headers = composeResponseHeaders(\n          timingToServerTimingResponseHeaders(serverTiming),\n          response.headers,\n        )\n      }\n\n      logger.info(`${request.method} ${request.origin}${request.ressource}`)\n\n      if (error && isCancelError(error) && internalCancellationToken.cancellationRequested) {\n        logger.info(\"ignored because server closing\")\n        nodeResponse.destroy()\n        return\n      }\n\n      if (request.aborted) {\n        logger.info(`request aborted by client`)\n        nodeResponse.destroy()\n        return\n      }\n\n      if (\n        request.method !== \"HEAD\" &&\n        response.headers[\"content-length\"] > 0 &&\n        response.body === \"\"\n      ) {\n        logger.error(\n          createContentLengthMismatchError(\n            `content-length header is ${response.headers[\"content-length\"]} but body is empty`,\n          ),\n        )\n      }\n\n      if (error) {\n        logger.error(`internal error while handling request.\n--- error stack ---\n${error.stack}\n--- request ---\n${request.method} ${request.origin}${request.ressource}`)\n      }\n      logger.info(`${colorizeResponseStatus(response.status)} ${response.statusText}`)\n\n      populateNodeResponse(nodeResponse, response, {\n        cancellationToken: request.cancellationToken,\n        ignoreBody: request.method === \"HEAD\",\n        // https://github.com/nodejs/node/blob/79296dc2d02c0b9872bbfcbb89148ea036a546d0/lib/internal/http2/compat.js#L97\n        ignoreStatusText: Boolean(nodeRequest.stream),\n        // https://github.com/nodejs/node/blob/79296dc2d02c0b9872bbfcbb89148ea036a546d0/lib/internal/http2/compat.js#L112\n        ignoreConnectionHeader: Boolean(nodeRequest.stream),\n      })\n\n      if (\n        stopOnInternalError &&\n        // stopOnInternalError stops server only if requestToResponse generated\n        // a non controlled error (internal error).\n        // if requestToResponse gracefully produced a 500 response (it did not throw)\n        // then we can assume we are still in control of what we are doing\n        error\n      ) {\n        // il faudrais pouvoir stop que les autres response ?\n        stop(STOP_REASON_INTERNAL_ERROR)\n      }\n    }\n\n    const removeRequestListener = trackServerRequest(nodeServer, requestCallback, { http2 })\n    // ensure we don't try to handle new requests while server is stopping\n    registerCleanupCallback(removeRequestListener)\n\n    logger.info(`${serverName} started at ${serverOrigin} (${serverOrigins.external})`)\n    startedCallback({ origin: serverOrigin })\n\n    const corsEnabled = accessControlAllowRequestOrigin || accessControlAllowedOrigins.length\n    // here we check access control options to throw or warn if we find strange values\n\n    const generateResponseDescription = async (request) => {\n      const responsePropertiesToResponse = ({\n        status = 501,\n        statusText = statusToStatusText(status),\n        headers = {},\n        body = \"\",\n        bodyEncoding,\n        timing,\n      }) => {\n        if (corsEnabled) {\n          const accessControlHeaders = generateAccessControlHeaders({\n            request,\n            accessControlAllowedOrigins,\n            accessControlAllowRequestOrigin,\n            accessControlAllowedMethods,\n            accessControlAllowRequestMethod,\n            accessControlAllowedHeaders,\n            accessControlAllowRequestHeaders,\n            accessControlAllowCredentials,\n            accessControlMaxAge,\n            sendServerTiming,\n          })\n\n          return {\n            status,\n            statusText,\n            headers: composeResponseHeaders(headers, accessControlHeaders),\n            body,\n            bodyEncoding,\n            timing,\n          }\n        }\n\n        return {\n          status,\n          statusText,\n          headers,\n          body,\n          bodyEncoding,\n          timing,\n        }\n      }\n\n      let timeout\n      try {\n        if (corsEnabled && request.method === \"OPTIONS\") {\n          return {\n            response: responsePropertiesToResponse({\n              status: 200,\n              headers: {\n                \"content-length\": 0,\n              },\n            }),\n          }\n        }\n\n        timeout = setTimeout(\n          () => requestWaitingCallback(request, { logger, requestWaitingMs }),\n          requestWaitingMs,\n        )\n\n        const responseProperties = await requestToResponse(request)\n        clearTimeout(timeout)\n        return {\n          response: responsePropertiesToResponse(responseProperties || {}),\n        }\n      } catch (error) {\n        clearTimeout(timeout)\n        return {\n          response: composeResponse(\n            responsePropertiesToResponse({\n              status: 500,\n              headers: {\n                // ensure error are not cached\n                \"cache-control\": \"no-store\",\n                \"content-type\": \"text/plain\",\n              },\n            }),\n            internalErrorToResponseProperties(error),\n          ),\n          error,\n        }\n      }\n    }\n\n    return {\n      getStatus: () => status,\n      origin: serverOrigin,\n      nodeServer,\n      stop,\n      stoppedPromise,\n    }\n  })\n}\n\nconst statusToStatusText = (status) => STATUS_CODES[status] || \"not specified\"\n\nconst createContentLengthMismatchError = (message) => {\n  const error = new Error(message)\n  error.code = \"CONTENT_LENGTH_MISMATCH\"\n  error.name = error.code\n  return error\n}\n\n// https://www.w3.org/TR/cors/\n// https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\nconst generateAccessControlHeaders = ({\n  request: { headers },\n  accessControlAllowedOrigins,\n  accessControlAllowRequestOrigin,\n  accessControlAllowedMethods,\n  accessControlAllowRequestMethod,\n  accessControlAllowedHeaders,\n  accessControlAllowRequestHeaders,\n  accessControlAllowCredentials,\n  // by default OPTIONS request can be cache for a long time, it's not going to change soon ?\n  // we could put a lot here, see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Max-Age\n  accessControlMaxAge = 600,\n  sendServerTiming,\n} = {}) => {\n  const vary = []\n\n  const allowedOriginArray = [...accessControlAllowedOrigins]\n  if (accessControlAllowRequestOrigin) {\n    if (\"origin\" in headers && headers.origin !== \"null\") {\n      allowedOriginArray.push(headers.origin)\n      vary.push(\"origin\")\n    } else if (\"referer\" in headers) {\n      allowedOriginArray.push(urlToOrigin(headers.referer))\n      vary.push(\"referer\")\n    } else {\n      allowedOriginArray.push(\"*\")\n    }\n  }\n\n  const allowedMethodArray = [...accessControlAllowedMethods]\n  if (accessControlAllowRequestMethod && \"access-control-request-method\" in headers) {\n    const requestMethodName = headers[\"access-control-request-method\"]\n    if (!allowedMethodArray.includes(requestMethodName)) {\n      allowedMethodArray.push(requestMethodName)\n      vary.push(\"access-control-request-method\")\n    }\n  }\n\n  const allowedHeaderArray = [...accessControlAllowedHeaders]\n  if (accessControlAllowRequestHeaders && \"access-control-request-headers\" in headers) {\n    const requestHeaderNameArray = headers[\"access-control-request-headers\"].split(\", \")\n    requestHeaderNameArray.forEach((headerName) => {\n      const headerNameLowerCase = headerName.toLowerCase()\n      if (!allowedHeaderArray.includes(headerNameLowerCase)) {\n        allowedHeaderArray.push(headerNameLowerCase)\n        if (!vary.includes(\"access-control-request-headers\")) {\n          vary.push(\"access-control-request-headers\")\n        }\n      }\n    })\n  }\n\n  return {\n    \"access-control-allow-origin\": allowedOriginArray.join(\", \"),\n    \"access-control-allow-methods\": allowedMethodArray.join(\", \"),\n    \"access-control-allow-headers\": allowedHeaderArray.join(\", \"),\n    ...(accessControlAllowCredentials ? { \"access-control-allow-credentials\": true } : {}),\n    \"access-control-max-age\": accessControlMaxAge,\n    ...(sendServerTiming ? { \"timing-allow-origin\": allowedOriginArray.join(\", \") } : {}),\n    ...(vary.length ? { vary: vary.join(\", \") } : {}),\n  }\n}\n\nconst composePredicate = (previousPredicate, predicate) => {\n  return (value) => {\n    return previousPredicate(value) || predicate(value)\n  }\n}\n"
  ],
  "names": [
    "acceptsContentType",
    "acceptHeader",
    "contentType",
    "split",
    "some",
    "acceptRaw",
    "accept",
    "parseAccept",
    "typeMatches",
    "type",
    "acceptTrimmed",
    "trim",
    "scoreIndex",
    "indexOf",
    "score",
    "beforeScore",
    "slice",
    "afterScore",
    "length",
    "parseFloat",
    "pattern",
    "typeComposition",
    "decomposeType",
    "patternComposition",
    "subtype",
    "fullType",
    "parts",
    "compositionMappingToComposeStrict",
    "compositionMapping",
    "createInitial",
    "reducer",
    "compositionMappingToStrictReducer",
    "objects",
    "reduce",
    "propertyComposeStrict",
    "key",
    "previous",
    "current",
    "propertyExistInCurrent",
    "propertyExistInPrevious",
    "composeProperty",
    "composed",
    "Object",
    "keys",
    "forEach",
    "compositionMappingToCompose",
    "compositionMappingToReducer",
    "propertyHasComposer",
    "composerForProperty",
    "composeHeaderValues",
    "value",
    "nextValue",
    "headerValues",
    "includes",
    "push",
    "join",
    "headerCompositionMapping",
    "composeResponseHeaders",
    "responseCompositionMapping",
    "status",
    "prevStatus",
    "statusText",
    "prevStatusText",
    "headers",
    "body",
    "prevBody",
    "bodyEncoding",
    "prevEncoding",
    "encoding",
    "timing",
    "prevTiming",
    "composeResponse",
    "convertFileSystemErrorToResponseProperties",
    "error",
    "isErrorWithCode",
    "path",
    "Promise",
    "reject",
    "code",
    "LOG_LEVEL_OFF",
    "LOG_LEVEL_DEBUG",
    "LOG_LEVEL_INFO",
    "LOG_LEVEL_WARN",
    "LOG_LEVEL_ERROR",
    "createLogger",
    "logLevel",
    "debug",
    "info",
    "warn",
    "debugDisabled",
    "infoDisabled",
    "warnDisabled",
    "errorDisabled",
    "Error",
    "console",
    "Symbol",
    "observable",
    "for",
    "createObservable",
    "subscribe",
    "next",
    "complete",
    "subscription",
    "unsubscribe",
    "isObservable",
    "undefined",
    "createSSERoom",
    "keepaliveDuration",
    "retryDuration",
    "historyLength",
    "maxConnectionAllowed",
    "computeEventId",
    "event",
    "lastEventId",
    "welcomeEvent",
    "welcomeEventPublic",
    "logger",
    "connections",
    "Set",
    "eventHistory",
    "createEventHistory",
    "previousEventId",
    "state",
    "interval",
    "eventsSince",
    "id",
    "events",
    "since",
    "filter",
    "connect",
    "lastKnownId",
    "size",
    "firstEvent",
    "retry",
    "data",
    "Date",
    "toLocaleTimeString",
    "add",
    "stringifySourceEvent",
    "connection",
    "write",
    "delete",
    "sendEvent",
    "keepAlive",
    "start",
    "setInterval",
    "stop",
    "clearInterval",
    "reset",
    "string",
    "limit",
    "shift",
    "index",
    "findIndex",
    "String",
    "nodeRequire",
    "require",
    "filenameContainsBackSlashes",
    "__filename",
    "url",
    "replace",
    "createCancellationToken",
    "register",
    "callback",
    "unregister",
    "throwIfRequested",
    "cancellationRequested",
    "memoizeOnce",
    "compute",
    "locked",
    "lockValue",
    "memoized",
    "args",
    "deleteCache",
    "createOperation",
    "cancellationToken",
    "rest",
    "unknownArgumentNames",
    "promise",
    "resolve",
    "cancelPromise",
    "cancelRegistration",
    "cancelError",
    "then",
    "operationPromise",
    "race",
    "createStoppableOperation",
    "TypeError",
    "stopInternal",
    "reason",
    "firstOperationMatching",
    "array",
    "predicate",
    "visit",
    "input",
    "output",
    "createCancelError",
    "name",
    "isCancelError",
    "composeCancellationToken",
    "tokens",
    "registrationArray",
    "i",
    "token",
    "registration",
    "compositeRegistration",
    "requested",
    "internalRegistration",
    "parentCancelError",
    "arrayWithout",
    "item",
    "arrayWithoutItem",
    "createCancellationSource",
    "cancel",
    "registrationArrayCopy",
    "existingRegistration",
    "find",
    "addCallback",
    "triggerHangUpOrDeath",
    "process",
    "once",
    "removeListener",
    "SIGUPSignal",
    "SIGINTSignal",
    "platform",
    "triggerTermination",
    "SIGTERMSignal",
    "beforeExitCallbackArray",
    "uninstall",
    "install",
    "beforeExitCallback",
    "onBeforeExit",
    "beforeExitSignal",
    "collectExceptions",
    "exitCallback",
    "on",
    "getExceptions",
    "trackExceptions",
    "exceptionArray",
    "map",
    "exception",
    "origin",
    "unhandledRejectionCallback",
    "unhandledRejection",
    "rejectionHandledCallback",
    "uncaughtExceptionCallback",
    "uncaughtException",
    "exitSignal",
    "eventRace",
    "SIGHUP",
    "SIGINT",
    "SIGTERM",
    "beforeExit",
    "exit",
    "eventMap",
    "unregisterMap",
    "unregisterAll",
    "teardownSignal",
    "createArrayErrorMessage",
    "createStartErrorMessage",
    "createPredicateErrorMessage",
    "returnValue",
    "recoverCallbackArray",
    "recoverCallback",
    "onUncaughtException",
    "triggerUncaughtException",
    "onUnhandledRejection",
    "triggerUnhandledRejection",
    "onRejectionHandled",
    "recoverExceptionMatching",
    "crash",
    "isCrashing",
    "crashReason",
    "resolveRecovering",
    "log",
    "externalRecoverPromise",
    "callbackRecoverPromise",
    "recovered",
    "recoverPromise",
    "unadvisedCrashSignal",
    "wrapFunctionToCatchCancellation",
    "asyncFunction",
    "wrapFunctionToConsiderUnhandledRejectionsAsExceptions",
    "fn",
    "installUnhandledRejectionMode",
    "setTimeout",
    "unhandledRejectionArg",
    "getCommandArgument",
    "execArgv",
    "argv",
    "arg",
    "startsWith",
    "executeAsyncFunction",
    "catchCancellation",
    "considerUnhandledRejectionsAsExceptions",
    "ensureUrlTrailingSlash",
    "endsWith",
    "isFileSystemPath",
    "startsWithWindowsDriveLetter",
    "firstChar",
    "test",
    "secondChar",
    "fileSystemPathToUrl",
    "pathToFileURL",
    "assertAndNormalizeDirectoryUrl",
    "urlString",
    "URL",
    "href",
    "e",
    "assertAndNormalizeFileUrl",
    "baseUrl",
    "urlToFileSystemPath",
    "fileUrl",
    "fileSystemPath",
    "fileURLToPath",
    "isWindows",
    "ETAG_FOR_EMPTY_CONTENT",
    "bufferToEtag",
    "buffer",
    "Buffer",
    "isBuffer",
    "hash",
    "createHash",
    "update",
    "hashBase64String",
    "digest",
    "hashBase64StringSubset",
    "toString",
    "readDirectory",
    "emfileMaxWait",
    "directoryUrl",
    "directoryPath",
    "startMs",
    "now",
    "attemptCount",
    "attempt",
    "readdirNaive",
    "handleTooManyFilesOpenedError",
    "nowMs",
    "timeSpentWaiting",
    "readdir",
    "names",
    "baseUrlFallback",
    "cwd",
    "memoize",
    "memoizedValue",
    "fnWithMemoization",
    "forget",
    "readFilePromisified",
    "promisify",
    "readFileNode",
    "isLinux",
    "timeStart",
    "startTimestamp",
    "performance",
    "timeEnd",
    "endTimestamp",
    "timeFunction",
    "timingToServerTimingResponseHeaders",
    "serverTimingValue",
    "time",
    "letters",
    "jsenvContentTypeMap",
    "extensions",
    "urlToContentType",
    "contentTypeMap",
    "contentTypeDefault",
    "pathname",
    "extensionWithDot",
    "extname",
    "extension",
    "availableContentTypes",
    "contentTypeForExtension",
    "contentTypeName",
    "readFile",
    "promises",
    "ETAG_CACHE",
    "Map",
    "ETAG_CACHE_MAX_SIZE",
    "serveFile",
    "source",
    "method",
    "etagEnabled",
    "etagCacheDisabled",
    "mtimeEnabled",
    "cacheControl",
    "canReadDirectory",
    "readableStreamLifetimeInSeconds",
    "sourceUrl",
    "readStatTiming",
    "sourceStat",
    "statSync",
    "clientCacheResponse",
    "getClientCacheResponse",
    "rawResponse",
    "getRawResponse",
    "destroy",
    "Infinity",
    "timeout",
    "onceReadableStreamUsedOrClosed",
    "clearTimeout",
    "getEtagResponse",
    "getMtimeResponse",
    "computeEtagTiming",
    "fileContentEtag",
    "computeEtag",
    "requestHasIfNoneMatchHeader",
    "etag",
    "etagCacheEntry",
    "get",
    "fileStatAreTheSame",
    "eTag",
    "fileContentAsBuffer",
    "firstKey",
    "Array",
    "from",
    "set",
    "leftFileStat",
    "rightFileStat",
    "fileStatKeysToCompare",
    "every",
    "keyToCompare",
    "leftValue",
    "rightValue",
    "cachedModificationDate",
    "actualModificationDate",
    "dateToSecondsPrecision",
    "mtime",
    "Number",
    "dateToUTCString",
    "isDirectory",
    "readDirectoryTiming",
    "directoryContentArray",
    "directoryContentJson",
    "JSON",
    "stringify",
    "isFile",
    "createReadStream",
    "emitClose",
    "readableStream",
    "dataOrCloseCallback",
    "date",
    "toUTCString",
    "dateWithSecondsPrecision",
    "setMilliseconds",
    "createRequire",
    "nodeFetch",
    "AbortController",
    "Response",
    "fetchUrl",
    "simplified",
    "ignoreHttpsError",
    "cacheStrategy",
    "options",
    "response",
    "standardResponseToSimplifiedResponse",
    "abortController",
    "abort",
    "signal",
    "agent",
    "Agent",
    "rejectUnauthorized",
    "message",
    "text",
    "responseToHeaders",
    "listen",
    "server",
    "port",
    "ip",
    "startListening",
    "stopListening",
    "address",
    "close",
    "findFreePort",
    "initialPort",
    "min",
    "max",
    "testUntil",
    "free",
    "portIsFree",
    "nextPort",
    "createServer",
    "listenOperation",
    "stopPromise",
    "firstService",
    "callbacks",
    "request",
    "serviceGeneratedResponsePredicate",
    "firstServiceWithTiming",
    "namedServices",
    "servicesTiming",
    "serviceName",
    "serviceFn",
    "serviceTiming",
    "assign",
    "jsenvAccessControlAllowedHeaders",
    "jsenvAccessControlAllowedMethods",
    "jsenvPrivateKey",
    "jsenvPublicKey",
    "jsenvCertificate",
    "urlToSearchParamValue",
    "searchParamName",
    "searchParams",
    "readRequestBodyAsString",
    "bufferArray",
    "bodyAsBuffer",
    "concat",
    "bodyAsString",
    "createTracker",
    "callbackArray",
    "registerCleanupCallback",
    "cleanup",
    "localCallbackArray",
    "all",
    "urlToOrigin",
    "http2",
    "http1Allowed",
    "protocol",
    "privateKey",
    "certificate",
    "createSecureServer",
    "cert",
    "allowHTTP1",
    "trackServerPendingConnections",
    "nodeServer",
    "onConnectionError",
    "trackHttp1ServerPendingConnections",
    "pendingConnections",
    "connectionListener",
    "pendingConnection",
    "trackServerPendingRequests",
    "trackHttp1ServerPendingRequests",
    "pendingClients",
    "requestListener",
    "nodeRequest",
    "nodeResponse",
    "client",
    "headersSent",
    "writeHead",
    "closed",
    "destroyed",
    "nodeStreamToObservable",
    "nodeStream",
    "normalizeHeaderName",
    "headerName",
    "toLowerCase",
    "normalizeHeaderValue",
    "headerValue",
    "headersFromObject",
    "headersObject",
    "nodeRequestToRequest",
    "serverCancellationToken",
    "serverOrigin",
    "ressource",
    "requestOrigin",
    "authority",
    "encrypted",
    "host",
    "freeze",
    "nodeRequestToCancellationToken",
    "valueToObservable",
    "populateNodeResponse",
    "ignoreBody",
    "ignoreStatusText",
    "ignoreConnectionHeader",
    "nodeHeaders",
    "headersToNodeHeaders",
    "end",
    "setEncoding",
    "bodyToObservable",
    "emit",
    "mapping",
    "nodeHeaderName",
    "isNodeStream",
    "Stream",
    "Writable",
    "Readable",
    "red",
    "green",
    "yellow",
    "magenta",
    "cyan",
    "colorizeResponseStatus",
    "statusType",
    "statusToType",
    "statusIsInformation",
    "statusIsSuccess",
    "statusIsRedirection",
    "statusIsClientError",
    "statusIsServerError",
    "getServerOrigins",
    "main",
    "createServerOrigin",
    "external",
    "getExternalIp",
    "hostname",
    "ipToHostname",
    "preferLocalhost",
    "preferLocalIp",
    "preferExternalIp",
    "networkInterfaceMap",
    "networkInterfaces",
    "internalIPV4NetworkAddress",
    "networkAddressArray",
    "networkAddress",
    "internal",
    "family",
    "createReason",
    "reasonString",
    "STOP_REASON_INTERNAL_ERROR",
    "STOP_REASON_PROCESS_SIGHUP",
    "STOP_REASON_PROCESS_SIGTERM",
    "STOP_REASON_PROCESS_SIGINT",
    "STOP_REASON_PROCESS_BEFORE_EXIT",
    "STOP_REASON_PROCESS_EXIT",
    "STOP_REASON_NOT_SPECIFIED",
    "trackServerRequest",
    "trackHttp1ServerRequest",
    "killPort",
    "startServer",
    "serverName",
    "redirectHttpToHttps",
    "portHint",
    "forcePort",
    "stopOnSIGINT",
    "stopOnExit",
    "stopOnInternalError",
    "stopOnCrash",
    "keepProcessAlive",
    "requestToResponse",
    "accessControlAllowedOrigins",
    "accessControlAllowedMethods",
    "accessControlAllowedHeaders",
    "accessControlAllowRequestOrigin",
    "accessControlAllowRequestMethod",
    "accessControlAllowRequestHeaders",
    "accessControlAllowCredentials",
    "accessControlMaxAge",
    "sendServerTiming",
    "sendInternalErrorStack",
    "internalErrorToResponseProperties",
    "stack",
    "byteLength",
    "requestWaitingMs",
    "requestWaitingCallback",
    "startedCallback",
    "stoppedCallback",
    "errorIsCancellation",
    "nagle",
    "internalCancellationSource",
    "externalCancellationToken",
    "internalCancellationToken",
    "onError",
    "composePredicate",
    "tearDownReason",
    "unref",
    "stoppedResolve",
    "stoppedPromise",
    "startOperation",
    "_",
    "serverOrigins",
    "connectionsTracker",
    "pendingRequestsTracker",
    "requestCallback",
    "setNoDelay",
    "location",
    "startRespondingTiming",
    "generateResponseDescription",
    "serverTiming",
    "aborted",
    "createContentLengthMismatchError",
    "Boolean",
    "stream",
    "removeRequestListener",
    "corsEnabled",
    "responsePropertiesToResponse",
    "statusToStatusText",
    "accessControlHeaders",
    "generateAccessControlHeaders",
    "responseProperties",
    "getStatus",
    "STATUS_CODES",
    "vary",
    "allowedOriginArray",
    "referer",
    "allowedMethodArray",
    "requestMethodName",
    "allowedHeaderArray",
    "requestHeaderNameArray",
    "headerNameLowerCase",
    "previousPredicate"
  ],
  "mappings": "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"
}